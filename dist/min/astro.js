/* autogenerated by webmerge (compile context) */
;
/* Vector3 implementation included */;
(function(window){if(typeof window.THREE=="undefined")window.THREE={};THREE.Vector3=function(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(x,y,z){this.x=x;this.y=y;this.z=z;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setZ:function(z){this.z=z;return this},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)},add:function(v1,
v2){this.x=v1.x+v2.x;this.y=v1.y+v2.y;this.z=v1.z+v2.z;return this},addSelf:function(v){this.x+=v.x;this.y+=v.y;this.z+=v.z;return this},addScalar:function(s){this.x+=s;this.y+=s;this.z+=s;return this},sub:function(v1,v2){this.x=v1.x-v2.x;this.y=v1.y-v2.y;this.z=v1.z-v2.z;return this},subSelf:function(v){this.x-=v.x;this.y-=v.y;this.z-=v.z;return this},multiply:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},multiplySelf:function(v){this.x*=v.x;this.y*=v.y;this.z*=v.z;return this},
multiplyScalar:function(s){this.x*=s;this.y*=s;this.z*=s;return this},divideSelf:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z;return this},divideScalar:function(s){if(s){this.x/=s;this.y/=s;this.z/=s}else{this.x=0;this.y=0;this.z=0}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return this.x+
this.y+this.z},normalize:function(){return this.divideScalar(this.length())},setLength:function(l){return this.normalize().multiplyScalar(l)},cross:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},crossSelf:function(v){var x=this.x,y=this.y,z=this.z;this.x=y*v.z-z*v.y;this.y=z*v.x-x*v.z;this.z=x*v.y-y*v.x;return this},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){return(new THREE.Vector3).sub(this,v).lengthSq()},
setPositionFromMatrix:function(m){this.x=m.n14;this.y=m.n24;this.z=m.n34},setRotationFromMatrix:function(m){var cosY=Math.cos(this.y);this.y=Math.asin(m.n13);if(Math.abs(cosY)>1E-5){this.x=Math.atan2(-m.n23/cosY,m.n33/cosY);this.z=Math.atan2(-m.n12/cosY,m.n11/cosY)}else{this.x=0;this.z=Math.atan2(m.n21,m.n22)}},isZero:function(){return this.lengthSq()<1E-4}};THREE.Vector3=function(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(x,y,z){this.x=
x;this.y=y;this.z=z;return this},setScalar:function(scalar){this.x=scalar;this.y=scalar;this.z=scalar;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setZ:function(z){this.z=z;return this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;default:throw new Error("index is out of range: "+index);}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;
case 2:return this.z;default:throw new Error("index is out of range: "+index);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this},add:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(v,w)}this.x+=v.x;this.y+=v.y;this.z+=v.z;return this},addScalar:function(s){this.x+=s;this.y+=s;this.z+=s;return this},addVectors:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(v,s){this.x+=v.x*s;this.y+=v.y*s;this.z+=v.z*s;return this},sub:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(v,w)}this.x-=v.x;this.y-=v.y;this.z-=v.z;return this},subScalar:function(s){this.x-=s;this.y-=s;this.z-=s;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},
multiply:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(v,w)}this.x*=v.x;this.y*=v.y;this.z*=v.z;return this},multiplyScalar:function(scalar){if(isFinite(scalar)){this.x*=scalar;this.y*=scalar;this.z*=scalar}else{this.x=0;this.y=0;this.z=0}return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var quaternion;
return function applyEuler(euler){if(euler instanceof THREE.Euler===false)console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");if(quaternion===undefined)quaternion=new THREE.Quaternion;this.applyQuaternion(quaternion.setFromEuler(euler));return this}}(),applyAxisAngle:function(){var quaternion;return function applyAxisAngle(axis,angle){if(quaternion===undefined)quaternion=new THREE.Quaternion;this.applyQuaternion(quaternion.setFromAxisAngle(axis,
angle));return this}}(),applyMatrix3:function(m){var x=this.x;var y=this.y;var z=this.z;var e=m.elements;this.x=e[0]*x+e[3]*y+e[6]*z;this.y=e[1]*x+e[4]*y+e[7]*z;this.z=e[2]*x+e[5]*y+e[8]*z;return this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+e[8]*z+e[12];this.y=e[1]*x+e[5]*y+e[9]*z+e[13];this.z=e[2]*x+e[6]*y+e[10]*z+e[14];return this},applyProjection:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;var d=1/(e[3]*x+e[7]*y+e[11]*z+e[15]);
this.x=(e[0]*x+e[4]*y+e[8]*z+e[12])*d;this.y=(e[1]*x+e[5]*y+e[9]*z+e[13])*d;this.z=(e[2]*x+e[6]*y+e[10]*z+e[14])*d;return this},applyQuaternion:function(q){var x=this.x;var y=this.y;var z=this.z;var qx=q.x;var qy=q.y;var qz=q.z;var qw=q.w;var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this},project:function(){var matrix;return function project(camera){if(matrix===
undefined)matrix=new THREE.Matrix4;matrix.multiplyMatrices(camera.projectionMatrix,matrix.getInverse(camera.matrixWorld));return this.applyProjection(matrix)}}(),unproject:function(){var matrix;return function unproject(camera){if(matrix===undefined)matrix=new THREE.Matrix4;matrix.multiplyMatrices(camera.matrixWorld,matrix.getInverse(camera.projectionMatrix));return this.applyProjection(matrix)}}(),transformDirection:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+
e[8]*z;this.y=e[1]*x+e[5]*y+e[9]*z;this.z=e[2]*x+e[6]*y+e[10]*z;this.normalize();return this},divide:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z;return this},divideScalar:function(scalar){return this.multiplyScalar(1/scalar)},min:function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);this.z=Math.min(this.z,v.z);return this},max:function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);this.z=Math.max(this.z,v.z);return this},clamp:function(min,max){this.x=Math.max(min.x,
Math.min(max.x,this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));this.z=Math.max(min.z,Math.min(max.z,this.z));return this},clampScalar:function(){var min,max;return function clampScalar(minVal,maxVal){if(min===undefined){min=new THREE.Vector3;max=new THREE.Vector3}min.set(minVal,minVal,minVal);max.set(maxVal,maxVal,maxVal);return this.clamp(min,max)}}(),clampLength:function(min,max){var length=this.length();this.multiplyScalar(Math.max(min,Math.min(max,length))/length);return this},floor:function(){this.x=
Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(length){return this.multiplyScalar(length/this.length())},lerp:function(v,alpha){this.x+=
(v.x-this.x)*alpha;this.y+=(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;return this},lerpVectors:function(v1,v2,alpha){this.subVectors(v2,v1).multiplyScalar(alpha).add(v1);return this},cross:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(v,w)}var x=this.x,y=this.y,z=this.z;this.x=y*v.z-z*v.y;this.y=z*v.x-x*v.z;this.z=x*v.y-y*v.x;return this},crossVectors:function(a,b){var ax=a.x,ay=
a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;this.x=ay*bz-az*by;this.y=az*bx-ax*bz;this.z=ax*by-ay*bx;return this},projectOnVector:function(){var v1,dot;return function projectOnVector(vector){if(v1===undefined)v1=new THREE.Vector3;v1.copy(vector).normalize();dot=this.dot(v1);return this.copy(v1).multiplyScalar(dot)}}(),projectOnPlane:function(){var v1;return function projectOnPlane(planeNormal){if(v1===undefined)v1=new THREE.Vector3;v1.copy(this).projectOnVector(planeNormal);return this.sub(v1)}}(),reflect:function(){var v1;
return function reflect(normal){if(v1===undefined)v1=new THREE.Vector3;return this.sub(v1.copy(normal).multiplyScalar(2*this.dot(normal)))}}(),angleTo:function(v){var theta=this.dot(v)/Math.sqrt(this.lengthSq()*v.lengthSq());return Math.acos(THREE.Math.clamp(theta,-1,1))},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x;var dy=this.y-v.y;var dz=this.z-v.z;return dx*dx+dy*dy+dz*dz},setFromSpherical:function(s){var sinPhiRadius=Math.sin(s.phi)*
s.radius;this.x=sinPhiRadius*Math.sin(s.theta);this.y=Math.cos(s.phi)*s.radius;this.z=sinPhiRadius*Math.cos(s.theta);return this},setFromMatrixPosition:function(m){return this.setFromMatrixColumn(m,3)},setFromMatrixScale:function(m){var sx=this.setFromMatrixColumn(m,0).length();var sy=this.setFromMatrixColumn(m,1).length();var sz=this.setFromMatrixColumn(m,2).length();this.x=sx;this.y=sy;this.z=sz;return this},setFromMatrixColumn:function(m,index){if(typeof m==="number"){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");
m=arguments[1];index=arguments[0]}return this.fromArray(m.elements,index*4)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z},fromArray:function(array,offset){if(offset===undefined)offset=0;this.x=array[offset];this.y=array[offset+1];this.z=array[offset+2];return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this.x;array[offset+1]=this.y;array[offset+2]=this.z;return array},fromAttribute:function(attribute,index,
offset){if(offset===undefined)offset=0;index=index*attribute.itemSize+offset;this.x=attribute.array[index];this.y=attribute.array[index+1];this.z=attribute.array[index+2];return this}};var AU2M=149597870700;var M2AU=1/AU2M;var AU2KM=AU2M/1E3;var KM2AU=M2AU*1E3;var KM2M=1E3;var M2KM=1/KM2M;var KM2AU2=KM2AU*KM2AU;var KM2AU3=KM2AU2*KM2AU;var T2K=2451545;var JY2JD=365.25;var JD2JY=1/JY2JD;var DAY2SEC=24*60*60;var SEC2DAY=1/DAY2SEC;var MSOL2KG=1.98855E30;var KG2MSOL=1/MSOL2KG;function JD2J2K(JD){return(JD-
T2K)/JY2JD}function J2K2JD(J2K){return J2K*JY2JD+T2K}var GMP={sun:2.959122083684144E-4,mer:4.912547451450812E-11,ven:7.243452486162703E-10,ear:8.997011603631609E-10,emb:8.997011603631609E-10,mar:9.549535105779258E-11,jup:2.825345842083778E-7,sat:8.459715185680659E-8,ura:1.2920249167819694E-8,nep:1.5243589007842763E-8,plu:2.1886997654259697E-12};var MAXLOOP=12;var EPSILON=1E-12;var PI=1*Math.PI;var TAU=2*Math.PI;var DEG2RAD=TAU/360;var RAD2DEG=360/TAU;var HMS2RAD=TAU/24;var RAD2HMS=24/TAU;var HMS2DEG=
360/24;var DEG2HMS=24/360;function CYCLE(rad){rad%=TAU;if(rad<0)rad+=TAU;return rad}function TURN(rad){rad%=TAU;if(rad>PI)rad-=TAU;return rad}Math.cbrt=Math.cbrt||function(x){var y=Math.pow(Math.abs(x),1/3);return x<0?-y:y};if(typeof THREE!="undefined")window.Vector3=THREE.Vector3;"use strict";(function(exports){function Orbit(arg){if(arg.empty)return this;this._G=GMP.sun;if("x"in arg&&"y"in arg&&"z"in arg)this._r=new Vector3(arg.x,arg.y,arg.z);else if("rx"in arg&&"ry"in arg&&"rz"in arg)this._r=new Vector3(arg.rx,
arg.ry,arg.rz);if("X"in arg&&"Y"in arg&&"Z"in arg)this._v=new Vector3(arg.X,arg.Y,arg.Z);else if("vx"in arg&&"vy"in arg&&"vz"in arg)this._v=new Vector3(arg.vx,arg.vy,arg.vz);if("r"in arg&&"v"in arg){var r=arg.r,v=arg.v;this._r=new Vector3(r.x,r.y,r.z);this._v=new Vector3(v.x,v.y,v.z)}this.vectors=!!(this._r&&this._v);var vars="aeiMnPLcCwWOkhqpG".split("");for(var i in vars)if(arg.hasOwnProperty(vars[i]))this["_"+vars[i]]=arg[vars[i]];if("name"in arg)this.name=arg.name;if(!this.lazy){this.updateElements();
this.requireElements()}}var Klass=Orbit.prototype;Klass.clone=function clone(dt){var clone=new Orbit({empty:true});if(dt){delete this._v;delete this._r}for(var key in this)if(this.hasOwnProperty(key))if(typeof this[key].clone=="function")clone[key]=this[key].clone();else clone[key]=this[key];if(dt)clone.update(dt);return clone};Klass.checkElements=function checkElements(full){if(!this.elements)throw"Orbitals not calculated";if(!("_i"in this))throw"Orbit is missing inclination (i)";if(!("_e"in this))throw"Orbit is missing eccentricity (e)";
if(!("_a"in this))throw"Orbit is missing semi-major axis (a)";if(!("_b"in this))throw"Orbit is missing semi-minor axis (b)";if(!("_l"in this))throw"Orbit is missing semi-latus rectum (l)";if(!("_c"in this))throw"Orbit is missing periapsis (c)";if(!("_C"in this))throw"Orbit is missing apoapsis (C)";if(!("_L"in this))throw"Orbit is missing mean longitude (L)";if(!("_O"in this))throw"Orbit is missing right ascending node (O)";if(!("_T"in this))throw"Orbit is missing time of periapsis (w)";if(!("_w"in
this))throw"Orbit is missing argument of periapsis (w)";if(!("_W"in this))throw"Orbit is missing longitude of the periapsis (W)";if(!("_n"in this))throw"Orbit is missing mean motion (n)";if(!("_M"in this))throw"Orbit is missing mean anomaly (M)";if(!("_P"in this))throw"Orbit is missing orbital period (P)";if(!("_A"in this))throw"Orbit is missing angular momentum (A)";if(!("_c"in this))throw"Orbit is missing pericenter (c)";if(!("_C"in this))throw"Orbit is missing apocenter (C)";if(full)if(!("_m"in
this))throw"Orbit is missing true anomaly (m)";if(full)if(!("_B"in this))throw"Orbit is missing radial velocity (B)";if(full)if(!("_E"in this))throw"Orbit is missing eccentric anomaly (E)";};Klass.requireElements=function requireElements(full){this.updateElements(full);this.checkElements(full);return this};Klass.updateElements=function updateElements(full){if(this.elements)return this;this.elements=true;if("_r"in this&&"_v"in this){var r=this._r,v=this._v,G=this._G,rl=r.length();this._A3=r.clone().cross(v);
this._A2=this._A3.lengthSq();this._A=Math.sqrt(this._A2);this._B=r.dot(v)/rl;var e3=this._e3=r.clone().multiplyScalar(v.lengthSq()-G/rl).sub(v.clone().multiplyScalar(rl*this._B)).multiplyScalar(1/G);var e2=e3.lengthSq(),e=this._e=Math.sqrt(e2);this._i=Math.acos(this._A3.z/this._A);this._l=this._A2/G;this._c=this._l/(1+e);this._C=this._l/(1-e);this._a=(this._C+this._c)/2;var nx=-this._A3.y,ny=+this._A3.x;var nl=Math.sqrt(nx*nx+ny*ny);var omega=nl==0?0:Math.acos(nx/nl);this._O=ny<0?TAU-omega:omega;
var nedot=nx*e3.x+ny*e3.y;if(nl===0||e===0)this.w=0;else this._w=Math.acos(nedot/nl/e);if(e3.z<0)this._w*=-1;var u;if(e===0&&nl===0)u=Math.acos(r.x/rl);else if(e===0){var nrdot=nx*r.x+ny*r.y;u=Math.acos(nrdot/(nl*rl))}else{var redot=e3.x*r.x+e3.y*r.y+e3.z*r.z;u=Math.acos(redot/e/rl)}var m=this._m=this._B<0?TAU-u:u;var E=this._E=CYCLE(Math.atan2(Math.sqrt(1-e*e)*Math.sin(m),e+Math.cos(m)));this._M=E-e*Math.sin(E)}if("_k"in this&&"_h"in this){this._W=Math.atan2(this._h,this._k);this._e=this._h/Math.sin(this._W)}if("_q"in
this&&"_p"in this){this._O=Math.atan2(this._p,this._q);var d=this._p-this._q,dt=-Math.sqrt(2)*Math.sin(PI/4-this._O);this._i=2*Math.asin(d/dt)}if("_n"in this&&!("_a"in this))this._a=Math.cbrt(this._G/this._n/this._n);if("_P"in this&&!("_a"in this)){var PTAU=this._P/TAU;this._a=Math.cbrt(this._G*PTAU*PTAU)}if(!("_a"in this))if("_c"in this&&"_C"in this)this._a=(this._C+this._c)/2;else if("_e"in this&&"_C"in this)this._a=this._C/(1+this._e);else if("_c"in this&&"_e"in this)this._a=this._c/(1-this._e);
if(!("_e"in this))if("_c"in this&&"_C"in this)this._e=1-this._c/this._a;else if("_a"in this&&"_C"in this)this._e=this._C/this._a-1;else if("_c"in this&&"_a"in this)this._e=1-this._c/this._a;if("_e"in this){var e2term=1-this._e*this._e;if("_a"in this){this._l=this._a*e2term;this._b=Math.sqrt(this._a*this._l)}else if("_b"in this){this._a=this._b/Math.sqrt(e2term);this._l=this._a*e2term}else if("_l"in this){this._a=this._l/e2term;this._b=Math.sqrt(this._a*this._l)}}else if("_a"in this)if("_b"in this){this._l=
this._b*this._b/this._a;this._e=Math.sqrt(1-this._l/this._a)}else{if("_l"in this){this._e=Math.sqrt(1-this._l/this._a);this._b=Math.sqrt(this._a*this._l)}}else if("_b"in this&&"_l"in this){this.a=this._b*this._b/this._l;this._e=Math.sqrt(1-this._l/this._a)}if("_a"in this&&!("_P"in this))this._P=TAU/Math.sqrt(this._G)*Math.pow(this._a,1.5);if("_P"in this&&!("_n"in this))this._n=TAU/this._P;if("_P"in this&&!("_A"in this))if("_a"in this&&"_b"in this)this._A=TAU*this._a*this._b/this._P;if("_a"in this&&
"_e"in this){if(!("_c"in this))this._c=this._a*(1-this._e);if(!("_C"in this))this._C=this._a*(1+this._e)}if("_L"in this)if("_M"in this){this._W=this._L-this._M;if("_O"in this)this._w=this._W-this._O;else if("_w"in this)this._O=this._W-this._w}else if("_W"in this){this._M=this._L-this._W;if("_O"in this)this._w=this._W-this._O;else if("_w"in this)this._O=this._W-this._w}else if("_O"in this&&"_w"in this){this._W=this._O+this._w;this._M=this._L-this._W}else throw"Orbit incomplete";else if("_O"in this)if("_w"in
this){this._W=this._O+this._w;if("_M"in this)this._L=this._M+this._W}else if("_W"in this){this._w=this._W-this._O;if("_M"in this)this._L=this._M+this._W}else throw"Orbit incomplete";else if("_M"in this&&"_w"in this&&"_W"in this){this._L=this._W+this._M;this._O=this._W-this._w}if(full)this.m();if("_W"in this)this._W=TURN(this._W);if("_L"in this)this._L=CYCLE(this._L);if("_M"in this)this._M=CYCLE(this._M);if("_O"in this)this._O=CYCLE(this._O);if("_w"in this)this._w=TURN(this._w);if("_M"in this&&"_n")this._T=
-this._M/this._n;return this};Klass.E=function eccentricAnomaly(dt){if("_E"in this&&!dt)return this._E;var e=this._e,m=this._m,M=this._M;if(!dt&&e!=null&&m!=null)return this._E=CYCLE(Math.atan2(Math.sqrt(1-e*e)*Math.sin(m),e+Math.cos(m)));if(e!=null&&M!=null){if(dt)M=CYCLE(this._n*(dt-this._T));var E=e<.8?M:PI,F;var F=E-e*Math.sin(M)-M;var f,dfdE,dE=1;for(var it=0;Math.abs(dE)>EPSILON&&it<MAXLOOP;++it){f=M-E+e*Math.sin(E);dfdE=e*Math.cos(E)-1;dE=f/dfdE;E-=dE}E=CYCLE(E);if(!dt)this._E=E;return E}throw"Invalid orbital state";
return null};Klass.m=function trueAnomaly(E){if(arguments.length===0){if("_m"in this)return this._m;var hE=this.E()/2;return this._m=CYCLE(2*Math.atan2(Math.sqrt(1+this._e)*Math.sin(hE),Math.sqrt(1-this._e)*Math.cos(hE)))}else return CYCLE(2*Math.atan2(Math.sqrt(1+this._e)*Math.sin(E/2),Math.sqrt(1-this._e)*Math.cos(E/2)))};Klass.B=function radialVelocity(){if("_B"in this)return this._B;var r=this.r(),v=this.v();return this._B=r.dot(v)/r.length()};Klass.e3=function eccentricity3(){if("_e3"in this)return this._e3;
var r=this.r(),v=this.v();if(r!==null&&v!==null)return this._e3=r.clone().multiplyScalar(v.lengthSq()-this._G/r.length()).sub(v.clone().multiplyScalar(r.length()*this.B())).multiplyScalar(1/this._G)};Klass.i=function inclination(){return this._i};Klass.e=function eccentricity(){return this._e};Klass.a=function semiMajorAxis(){return this._a};Klass.b=function semiMinorAxis(){return this._b};Klass.l=function semilatusRectum(){return this._l};Klass.C=function apocenter(){return this._C};Klass.c=function pericenter(){return this._c};
Klass.L=function meanLongitude(){return this._L};Klass.O=function ascendingNode(){return this._O};Klass.w=function argOfPeriapsis(){return this._w};Klass.T=function timeOfPericenter(){return this._T};Klass.W=function longitudeOfPeriapsis(){return this._W};Klass.n=function meanMotion(){return this._n};Klass.A=function angularMomentum(){return this._A};Klass.M=function meanAnomaly(){return this._M};Klass.P=function orbitalPeriod(){return this._P};Klass.q=function vsopPeriapsis(){if("_q"in this)return this._q;
return this._q=Math.cos(this._O)*Math.sin(this._i/2)};Klass.p=function vsopApoapsis(){if("_p"in this)return this._p;return this._p=Math.sin(this._O)*Math.sin(this._i/2)};Klass.k=function vsopK(){if("_k"in this)return this._k;return this._k=this._e*Math.cos(this._W)};Klass.h=function vsopH(){if("_h"in this)return this._h;return this._h=this._e*Math.sin(this._W)};Klass.update=function update(dt){if(!this.elements)this.resolveElements(true);this._M=CYCLE(this._n*(dt-this._T));this._L=CYCLE(this._M+this._W);
delete this._E;delete this._m;delete this._r;delete this._v;return this};Klass.state=function spherical(dt){};Klass.state=function state(dt){if(!this.elements)this.resolveElements(true);var e=this._e,a=this._a,i=this._i,O=this._O,w=this._w,M=this._M,E=this.E(),m=this.m(),t=dt||0;var r=a*(1-e*Math.cos(E));var vf=Math.sqrt(this._G*a)/r;var rx=r*Math.cos(m),ry=r*Math.sin(m),vx=vf*-Math.sin(E),vy=vf*Math.sqrt(1-e*e)*Math.cos(E);var sinO=Math.sin(O),cosO=Math.cos(O),sinI=Math.sin(i),cosI=Math.cos(i),sinW=
Math.sin(w),cosW=Math.cos(w),sinWcosO=sinW*cosO,sinWsinO=sinW*sinO,cosWcosO=cosW*cosO,cosWsinO=cosW*sinO,FxX=cosW*cosO-sinW*sinO*cosI,FyX=cosW*sinO+sinW*cosO*cosI,FxY=cosW*sinO*cosI+sinW*cosO,FyY=cosW*cosO*cosI-sinW*sinO,FzX=sinW*sinI,FzY=cosW*sinI;var r=new Vector3(rx*FxX-ry*FxY,rx*FyX+ry*FyY,rx*FzX+ry*FzY);var v=new Vector3(vx*FxX-vy*FxY,vx*FyX+vy*FyY,vx*FzX+vy*FzY);if(!t)this._r=r,this._v=v;return{r:r,v:v,time:t,orbit:this}};Klass.r=function position3(){if("_r"in this)return this._r;var state=
this.state(0);this._r=state.r;this._v=state.v;return state.r};Klass.v=function velocity3(){if("_v"in this)return this._v;var state=this.state(0);this._r=state.r;this._v=state.v;return state.v};Klass.inclination=Klass.i;Klass.eccentricity=Klass.e;Klass.semiMajorAxis=Klass.a;Klass.semiMinorAxis=Klass.b;Klass.semilatusRectum=Klass.l;Klass.meanLongitude=Klass.L;Klass.ascendingNode=Klass.O;Klass.argOfPericenter=Klass.w;Klass.timeOfPericenter=Klass.T;Klass.longitudeOfPericenter=Klass.W;Klass.meanMotion=
Klass.n;Klass.meanAnomaly=Klass.M;Klass.orbitalPeriod=Klass.P;Klass.angularMomentum=Klass.A;Klass.trueAnomaly=Klass.m;Klass.radialVelocity=Klass.B;Klass.eccentricAnomaly=Klass.E;Klass.apoapsis=Klass.C;Klass.aphelion=Klass.C;Klass.apocenter=Klass.C;Klass.periapsis=Klass.c;Klass.perhelion=Klass.c;Klass.pericenter=Klass.c;Klass.position=Klass.r;Klass.velocity=Klass.v;exports.Orbit=exports.Orbital=Orbit})(this);"use strict";(function(exports){var delta_t=[124,115,106,98,91,85,79,74,70,65,62,58,55,53,
50,48,46,44,42,40,37,35,33,31,28,26,24,22,20,18,16,14,13,12,11,10,9,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,14,14,14,15,15,15,15,16,16,16,16,16,17,17,17,17,17,17,17,17,16,16,15,14,13.7,13.1,12.7,12.5,12.5,12.5,12.5,12.5,12.5,12.3,12,11.4,10.6,9.6,8.6,7.5,6.6,6,5.7,5.6,5.7,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.7,7.8,7.9,7.5,6.4,5.4,2.9,1.6,-1,-2.7,-3.6,-4.7,-5.4,-5.2,-5.5,-5.6,-5.8,-5.9,-6.2,-6.4,-6.1,-4.7,-2.7,0,2.6,5.4,7.7,10.5,13.4,16,18.2,20.2,21.2,22.4,23.5,23.9,
24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.2,42.2,44.5,46.5,48.5,50.5,52.2,53.8,54.9,55.8,56.9,58.3];var nut_args=[[0,0,0,0,1],[-2,0,0,2,2],[0,0,0,2,2],[0,0,0,0,2],[0,1,0,0,0],[0,0,1,0,0],[-2,1,0,2,2],[0,0,0,2,1],[0,0,1,2,2],[-2,-1,0,2,2],[-2,0,1,0,0],[-2,0,0,2,1],[0,0,-1,2,2],[2,0,0,0,0],[0,0,1,0,1],[2,0,-1,2,2],[0,0,-1,0,1],[0,0,1,2,1],[-2,0,2,0,0],[0,0,-2,2,1],[2,0,0,2,2],[0,0,2,2,2],[0,0,2,0,0],[-2,0,1,2,2],[0,0,0,2,0],[-2,0,0,2,0],[0,0,-1,
2,1],[0,2,0,0,0],[2,0,-1,0,1],[-2,2,0,2,2],[0,1,0,0,1],[-2,0,1,0,1],[0,-1,0,0,1],[0,0,2,-2,0],[2,0,-1,2,1],[2,0,1,2,2],[0,1,0,2,2],[-2,1,1,0,0],[0,-1,0,2,2],[2,0,0,2,1],[2,0,1,0,0],[-2,0,2,2,2],[-2,0,1,2,1],[2,0,-2,0,1],[2,0,0,0,1],[0,-1,1,0,0],[-2,-1,0,2,1],[-2,0,0,0,1],[0,0,2,2,1],[-2,0,2,0,1],[-2,1,0,2,1],[0,0,1,-2,0],[-1,0,1,0,0],[-2,1,0,0,0],[1,0,0,0,0],[0,0,1,2,0],[0,0,-2,2,2],[-1,-1,1,0,0],[0,1,1,0,0],[0,-1,1,2,2],[2,-1,-1,2,2],[0,0,3,2,2],[2,-1,0,2,2]];var nut_coeffs=[[-171996,-174.2,92025,
8.9],[-13187,-1.6,5736,-3.1],[-2274,-.2,977,-.5],[2062,.2,-895,.5],[1426,-3.4,54,-.1],[712,.1,-7,0],[-517,1.2,224,-.6],[-386,-.4,200,0],[-301,0,129,-.1],[217,-.5,-95,.3],[-158,0,0,0],[129,.1,-70,0],[123,0,-53,0],[63,0,0,0],[63,.1,-33,0],[-59,0,26,0],[-58,-.1,32,0],[-51,0,27,0],[48,0,0,0],[46,0,-24,0],[-38,0,16,0],[-31,0,13,0],[29,0,0,0],[29,0,-12,0],[26,0,0,0],[-22,0,0,0],[21,0,-10,0],[17,-.1,0,0],[16,0,-8,0],[-16,.1,7,0],[-15,0,9,0],[-13,0,7,0],[-12,0,6,0],[11,0,0,0],[-10,0,5,0],[-8,0,3,0],[7,0,
-3,0],[-7,0,0,0],[-7,0,3,0],[-7,0,3,0],[6,0,0,0],[6,0,-3,0],[6,0,-3,0],[-6,0,3,0],[-6,0,3,0],[5,0,0,0],[-5,0,3,0],[-5,0,3,0],[-5,0,3,0],[4,0,0,0],[4,0,0,0],[4,0,0,0],[-4,0,0,0],[-4,0,0,0],[-4,0,0,0],[3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0]];var FD0=297.85036*DEG2RAD,FD1=445267.11148*DEG2RAD,FD2=-.0019142*DEG2RAD,FD3=DEG2RAD/189474,FM0=357.52772*DEG2RAD,FM1=35999.05034*DEG2RAD,FM2=-.0086972*DEG2RAD,FM3=-DEG2RAD/3E5,FMM0=134.96298*DEG2RAD,FMM1=477198.867398*
DEG2RAD,FMM2=.0086972*DEG2RAD,FMM3=DEG2RAD/56250,FF0=93.27191*DEG2RAD,FF1=483202.017538*DEG2RAD,FF2=-.0036825*DEG2RAD,FF3=DEG2RAD/327270,FO0=125.04452*DEG2RAD,FO1=-1934.136261*DEG2RAD,FO2=.0020708*DEG2RAD,FO3=DEG2RAD/45E4;function getNutation(JD){var JDE=JD2JDE(JD);var T=JD2J2K(JDE)/100,T2=T*T,T3=T2*T;var D=FD0+FD1*T+FD2*T2+FD3*T3;var M=FM0+FM1*T+FM2*T2+FM3*T3;var MM=FMM0+FMM1*T+FMM2*T2+FMM3*T3;var F=FF0+FF1*T+FF2*T2+FF3*T3;var O=FO0+FO1*T+FO2*T2+FO3*T3;var c_longitude=0,c_obliquity=0;var coeff_sine,
coeff_cos,arg;for(var i=0;i<nut_coeffs.length;i++){coeff_sine=nut_coeffs[i][0]+nut_coeffs[i][1]*T;coeff_cos=nut_coeffs[i][2]+nut_coeffs[i][3]*T;arg=nut_args[i][0]*D+nut_args[i][1]*M+nut_args[i][2]*MM+nut_args[i][3]*F+nut_args[i][4]*O;c_longitude+=coeff_sine*Math.sin(arg);c_obliquity+=coeff_cos*Math.cos(arg)}var c_ecliptic=23+26/60+21.448/3600-46.815/3600*T-5.9E-4/3600*T2+.001813/3600*T3;c_ecliptic*=DEG2RAD;c_longitude/=3600*100*100/DEG2RAD;c_obliquity/=3600*100*100/DEG2RAD;return{longitude:TURN(c_longitude),
obliquity:TURN(c_obliquity),ecliptic:CYCLE(c_ecliptic)}}function getDynamicalTimeDiffSH1(JD){var E=(JD-2067314.5)/36525;return 1830-405*E+46.5*E*E}function getDynamicalTimeDiffSH2(JD){var t=(JD-2396758.5)/36525;return 22.5*t*t}function getDynamicalTimeDiffTable(JD){var i=Math.floor((JD-2312752.5)/730.5);if(i>delta_t.length-2)i=delta_t.length-2;var a=delta_t[i+1]-delta_t[i],b=delta_t[i+2]-delta_t[i+1],c=a-b,n=(JD-(2312752.5+730.5*i))/730.5;return delta_t[i+1]+n/2*(a+b+n*c)}function getDynamicalTimeDiffNear(JD){var delta_T=
[56.86,63.83,70];var a=delta_T[1]-delta_T[0],b=delta_T[2]-delta_T[1],c=b-a;var n=(JD-2451544.5)/3652.5;return delta_T[1]+n/2*(a+b+n*c)}function getDynamicalTimeDiffElse(JD){var a=JD-2382148;return-15+a*a/41048480}function getDynamicalTimeDiff(JD){if(JD<2067314.5)return getDynamicalTimeDiffSH1(JD);else if(JD>=2067314.5&&JD<2305447.5)return getDynamicalTimeDiffSH2(JD);else if(JD>=2312752.5&&JD<2448622.5)return getDynamicalTimeDiffTable(JD);else if(JD>=2448622.5&&JD<=2455197.5)return getDynamicalTimeDiffNear(JD);
return getDynamicalTimeDiffElse(JD)}function JD2JDE(JD){return JD+getDynamicalTimeDiff(JD)/DAY2SEC}function JDE2JD(JDE){return JDE-getDynamicalTimeDiff(JDE)/DAY2SEC}var FST1=280.46061837*DEG2RAD,FST2=360.98564736629*DEG2RAD,FST3=3.87933E-4*DEG2RAD,FST4=-DEG2RAD/3871E4,FLON=15*DEG2HMS;function getMeanSiderealTime(JD){var T=JD2J2K(JD)/100;var sidereal=FST1+FST2*(JD-2451545)+FST3*T*T+FST4*T*T*T;return CYCLE(sidereal)}function getApparentSiderealTime(JD){var nutation=getNutation(JD);return getMeanSiderealTime(JD)+
nutation.longitude/FLON*Math.cos(nutation.obliquity)}exports.JD2JDE=JD2JDE;exports.JDE2JD=JDE2JD;exports.getMeanSiderealTime=getMeanSiderealTime;exports.getApparentSiderealTime=getApparentSiderealTime;exports.getNutation=getNutation})(this);"use strict";(function(exports){function cyl(){return{p:this.p,l:this.l,z:this.z}}function cart(){return{x:this.x,y:this.y,z:this.z}}function sph(){return{l:this.l,b:this.b,i:this.i,r:this.r}}function cart2sph(){this.r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*
this.z);this.i=Math.acos(this.z/this.r),this.b=PI/2-this.i;this.l=Math.atan2(this.y,this.x);return(this.sph=sph).call(this)}function sph2cart(){var rsb=this.r*Math.sin(this.i);this.x=rsb*Math.cos(this.l);this.y=rsb*Math.sin(this.l);this.z=this.r*Math.cos(this.i);return(this.cart=cart).call(this)}function cart2cyl(){this.p=Math.sqrt(this.x*this.x+this.y*this.y);this.l=Math.atan2(this.y,this.x);return(this.cyl=cyl).call(this)}function cyl2cart(){this.x=this.p*Math.cos(this.l);this.y=this.p*Math.sin(this.l);
return(this.cart=cart).call(this)}function cyl2sph(){this.i=Math.atan2(this.p,this.z),this.b=PI/2-this.i;this.r=Math.sqrt(this.p*this.p+this.z*this.z);return(this.sph=sph).call(this)}function sph2cyl(){this.p=this.r*Math.cos(this.b);this.z=this.r*Math.sin(this.b);return(this.cyl=cyl).call(this)}function Coord(state){if("x"in state&&"y"in state&&"z"in state){this.x=state.x,this.y=state.y,this.z=state.z;this.cart=cart,this.sph=cart2sph,this.cyl=cart2cyl}else if("p"in state&&"l"in state&&"z"in state){this.p=
state.p,this.l=state.l,this.z=state.z;this.cart=cyl2cart,this.sph=cyl2sph,this.cyl=cyl}else if("l"in state&&"r"in state){this.l=state.l,this.r=state.r;if("i"in state||"b"in state){this.cart=sph2cart,this.sph=sph,this.cyl=sph2cyl;if("b"in state)this.b=state.b,this.i=PI/2-this.b;else if("i"in state)this.i=state.i,this.b=PI/2-this.i}}}Coord.prototype.ecl2equ=function ecl2equ(tilt){var cart=this.cart(),sin_e=Math.sin(tilt),cos_e=Math.cos(tilt);return new Coord({x:cart.x,y:cart.y*cos_e-cart.z*sin_e,z:cart.z*
cos_e+cart.y*sin_e})};Coord.prototype.equ2ecl=function equ2ecl(tilt){var cart=this.cart(),sin_e=Math.sin(tilt),cos_e=Math.cos(tilt);return new Coord({x:cart.x,y:cart.y*cos_e+cart.z*sin_e,z:cart.z*cos_e-cart.y*sin_e})};var posangle=32.932*DEG2RAD;var pole_ra=192.859508*DEG2RAD;var pole_dec=27.128336*DEG2RAD;Coord.prototype.gal2equ=function gal2equ(){var sph=this.sph(),l=sph.l,b=sph.b,sin_b=Math.sin(b),cos_b=Math.cos(b),sin_pdc=Math.sin(pole_dec),cos_pdc=Math.cos(pole_dec),sin_pos=Math.sin(l-posangle),
cos_pos=Math.cos(l-posangle),sincos_bp=cos_b*sin_pos;var B=Math.asin(sin_b*sin_pdc+sincos_bp*cos_pdc);var L=Math.atan2(cos_b*cos_pos,sin_b*cos_pdc-sincos_bp*sin_pdc);return{l:CYCLE(L+pole_ra),b:TURN(B)}};Coord.prototype.equ2gal=function equ2gal(){var sph=this.sph(),l=sph.l,b=sph.b,sin_b=Math.sin(b),cos_b=Math.cos(b),tan_b=sin_b/cos_b,sin_pdc=Math.sin(pole_dec),cos_pdc=Math.cos(pole_dec),sin_pos=Math.sin(pole_ra-l),cos_pos=Math.cos(pole_ra-l),sincos_bp=cos_b*sin_pos;var B=Math.asin(sin_b*sin_pdc+cos_b*
cos_pdc*cos_pos);var L=Math.atan2(sin_pos,cos_pos*sin_pdc-tan_b*cos_pdc);return{l:CYCLE(posangle-L-PI/2),b:TURN(B)}};var PFA=2306.2181*DEG2RAD,PFB=1.39656*DEG2RAD,PFC=1.39E-4*DEG2RAD,PFD=.30188*DEG2RAD,PFE=3.44E-4*DEG2RAD,PFF=.017998*DEG2RAD,PFG=1.09468*DEG2RAD,PFH=6.6E-5*DEG2RAD,PFI=.018203*DEG2RAD,PFJ=2004.3109*DEG2RAD,PFK=.8533*DEG2RAD,PFL=2.17E-4*DEG2RAD,PFM=.42665*DEG2RAD,PFN=2.17E-4*DEG2RAD,PFP=.041833*DEG2RAD;Coord.prototype.precess=function precess(JD,epoch){var mean_ra=this.l,mean_dec=this.b;
var eta,zeta,theta,T,T2,t=(JD-epoch)/36E4,t2=t*t,t3=t2*t;if(t){T=epoch/36E4,T2=T*T;eta=(PFA+PFB*T-PFC*T2)*t+(PFG+PFH*T)*t2+PFI*t3;zeta=(PFA+PFB*T-PFC*T2)*t+(PFD-PFE*T)*t2+PFF*t3;theta=(PFJ-PFK*T-PFN*T2)*t-(PFM+PFN*T)*t2-PFP*t3}else{eta=PFA*t+PFG*t2+PFP*t3;zeta=PFA*t+PFD*t2+PFF*t3;theta=PFJ*t-PFN*t2-PFP*t3}var sin_md=Math.sin(mean_dec),cos_md=Math.cos(mean_dec),mean_term=cos_md*Math.cos(mean_ra+zeta),A=cos_md*Math.sin(mean_ra+zeta),B=Math.cos(theta)*mean_term-Math.sin(theta)*Math.sin(mean_dec),C=Math.sin(theta)*
mean_term+Math.cos(theta)*Math.sin(mean_dec);var ra=Math.atan2(A,B)+eta,dec;if(mean_dec>.4*PI||mean_dec<-.4*PI){dec=Math.acos(sqrt(A*A+B*B));if(mean_dec<0)dec*=-1}else dec=Math.asin(C);return{l:CYCLE(ra),b:TURN(dec)}};exports.Coord=Coord})(this)})(window);

/* crc: D19F19BC0541F84B4AFE87EDFBD8F812 */
