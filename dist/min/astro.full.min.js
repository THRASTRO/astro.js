/* autogenerated by webmerge (compile context) */
;
/*
Astronomical Calculations (https://github.com/mgreter/astro.js)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
/* Vector3 implementation included */;
(function(E){(function(){function m(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function p(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function d(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function k(a,b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==e?e:1}function q(a,
b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._order=e||q.DefaultOrder}if(!this.THREE){var l={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var f=0;36>f;f++)8===f||13===f||18===f||23===f?b[f]="-":14===f?b[f]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[f]=a[19===f?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,
a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,e,f){return e+(a-b)*(f-e)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*
(.5-Math.random())},degToRad:function(a){return a*l.DEG2RAD},radToDeg:function(a){return a*l.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};q.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");q.DefaultOrder="XYZ";Object.assign(m.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setScalar:function(a){this.z=
this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=
a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new k;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new k;return function(b,
c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*e;this.y=a[1]*b+a[4]*c+a[7]*e;this.z=a[2]*b+a[5]*c+a[8]*e;return this},applyMatrix4:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;var f=1/(a[3]*b+a[7]*c+a[11]*e+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*e+a[12])*f;this.y=(a[1]*b+a[5]*c+a[9]*e+a[13])*f;this.z=(a[2]*b+a[6]*c+a[10]*e+a[14])*f;return this},applyQuaternion:function(a){var b=this.x,
c=this.y,e=this.z,f=a.x,h=a.y,g=a.z;a=a.w;var n=a*b+h*e-g*c,r=a*c+g*b-f*e,y=a*e+f*c-h*b;b=-f*b-h*c-g*e;this.x=n*a+b*-f+r*-g-y*-h;this.y=r*a+b*-h+y*-f-n*-g;this.z=y*a+b*-g+n*-h-r*-f;return this},project:function(){var a=new d;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new d;return function(b){a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=
this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e;this.y=a[1]*b+a[5]*c+a[9]*e;this.z=a[2]*b+a[6]*c+a[10]*e;return this.normalize()},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,
b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a=new m,b=new m;return function(c,e){a.set(c,c,c);b.set(e,e,e);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*
a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);b=this.x;var c=this.y,e=this.z;this.x=c*a.z-e*a.y;this.y=e*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},crossVectors:function(a,b){var c=a.x,e=a.y;a=a.z;var f=b.x,h=b.y;b=b.z;this.x=e*b-a*h;this.y=a*f-c*b;this.z=c*h-e*f;return this},projectOnVector:function(a){var b=a.dot(this)/
a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new m;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new m;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(l.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=
this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},distanceToManhattan:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];
this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);
void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(p.prototype,{isMatrix3:!0,set:function(a,b,c,e,f,h,g,n,r){var y=this.elements;y[0]=a;y[1]=e;y[2]=g;y[3]=b;y[4]=f;y[5]=n;y[6]=c;y[7]=h;y[8]=r;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},
copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new m;return function(b){for(var c=0,e=b.count;c<e;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,
a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,e=b.elements;b=this.elements;a=c[0];var f=c[3],h=c[6],g=c[1],n=c[4],r=c[7],y=c[2],d=c[5];c=c[8];var k=e[0],l=e[3],q=e[6],m=e[1],v=e[4],z=e[7],w=e[2],p=e[5];e=e[8];b[0]=a*k+f*m+h*w;b[3]=a*l+f*v+h*p;b[6]=a*q+f*z+h*e;b[1]=g*k+n*m+r*w;b[4]=g*l+n*v+r*p;b[7]=g*q+n*z+r*e;b[2]=y*k+d*m+c*w;b[5]=y*l+d*v+c*p;b[8]=y*q+d*z+c*e;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=
a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],e=a[2],f=a[3],h=a[4],g=a[5],n=a[6],r=a[7];a=a[8];return b*h*a-b*g*r-c*f*a+c*g*n+e*f*r-e*h*n},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var e=c[0],f=c[1],h=c[2],g=c[3],n=c[4],r=c[5],y=c[6],d=c[7];c=c[8];var k=c*n-r*d,l=r*y-c*g,q=d*g-n*y,m=e*k+f*l+h*q;if(0===m){if(!0===
b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/m;a[0]=k*b;a[1]=(h*d-c*f)*b;a[2]=(r*f-h*n)*b;a[3]=l*b;a[4]=(c*e-h*y)*b;a[5]=(h*g-r*e)*b;a[6]=q*b;a[7]=(f*y-d*e)*b;a[8]=(n*e-f*g)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},
transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=
c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});Object.assign(d.prototype,{isMatrix4:!0,set:function(a,b,c,e,f,h,g,n,r,y,d,k,l,q,m,v){var A=this.elements;A[0]=a;A[4]=b;A[8]=c;A[12]=e;A[1]=f;A[5]=h;A[9]=g;A[13]=n;A[2]=r;A[6]=y;A[10]=d;A[14]=k;A[3]=l;A[7]=q;A[11]=m;A[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new d).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];
b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=
new m;return function(b){var c=this.elements,e=b.elements,f=1/a.setFromMatrixColumn(b,0).length(),h=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,2).length();c[0]=e[0]*f;c[1]=e[1]*f;c[2]=e[2]*f;c[4]=e[4]*h;c[5]=e[5]*h;c[6]=e[6]*h;c[8]=e[8]*b;c[9]=e[9]*b;c[10]=e[10]*b;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,e=a.y,
f=a.z,h=Math.cos(c);c=Math.sin(c);var g=Math.cos(e);e=Math.sin(e);var n=Math.cos(f);f=Math.sin(f);if("XYZ"===a.order){a=h*n;var r=h*f,d=c*n,k=c*f;b[0]=g*n;b[4]=-g*f;b[8]=e;b[1]=r+d*e;b[5]=a-k*e;b[9]=-c*g;b[2]=k-a*e;b[6]=d+r*e;b[10]=h*g}else"YXZ"===a.order?(a=g*n,r=g*f,d=e*n,k=e*f,b[0]=a+k*c,b[4]=d*c-r,b[8]=h*e,b[1]=h*f,b[5]=h*n,b[9]=-c,b[2]=r*c-d,b[6]=k+a*c,b[10]=h*g):"ZXY"===a.order?(a=g*n,r=g*f,d=e*n,k=e*f,b[0]=a-k*c,b[4]=-h*f,b[8]=d+r*c,b[1]=r+d*c,b[5]=h*n,b[9]=k-a*c,b[2]=-h*e,b[6]=c,b[10]=h*g):
"ZYX"===a.order?(a=h*n,r=h*f,d=c*n,k=c*f,b[0]=g*n,b[4]=d*e-r,b[8]=a*e+k,b[1]=g*f,b[5]=k*e+a,b[9]=r*e-d,b[2]=-e,b[6]=c*g,b[10]=h*g):"YZX"===a.order?(a=h*g,r=h*e,d=c*g,k=c*e,b[0]=g*n,b[4]=k-a*f,b[8]=d*f+r,b[1]=f,b[5]=h*n,b[9]=-c*n,b[2]=-e*n,b[6]=r*f+d,b[10]=a-k*f):"XZY"===a.order&&(a=h*g,r=h*e,d=c*g,k=c*e,b[0]=g*n,b[4]=-f,b[8]=e*n,b[1]=a*f+k,b[5]=h*n,b[9]=r*f-d,b[2]=d*f-r,b[6]=c*n,b[10]=k*f+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(a){var b=
this.elements,c=a._x,e=a._y,f=a._z,h=a._w,g=c+c,n=e+e,r=f+f;a=c*g;var d=c*n;c*=r;var k=e*n;e*=r;f*=r;g*=h;n*=h;h*=r;b[0]=1-(k+f);b[4]=d-h;b[8]=c+n;b[1]=d+h;b[5]=1-(a+f);b[9]=e-g;b[2]=c-n;b[6]=e+g;b[10]=1-(a+k);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new m,b=new m,c=new m;return function(e,f,h){var g=this.elements;c.subVectors(e,f);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(h,c);0===a.lengthSq()&&(1===Math.abs(h.z)?c.x+=1E-4:c.z+=1E-4,
c.normalize(),a.crossVectors(h,c));a.normalize();b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,e=b.elements;
b=this.elements;a=c[0];var f=c[4],h=c[8],g=c[12],n=c[1],r=c[5],d=c[9],k=c[13],l=c[2],q=c[6],m=c[10],u=c[14],v=c[3],p=c[7],w=c[11];c=c[15];var t=e[0],x=e[4],H=e[8],I=e[12],F=e[1],K=e[5],L=e[9],J=e[13],N=e[2],O=e[6],P=e[10],Q=e[14],B=e[3],C=e[7],D=e[11];e=e[15];b[0]=a*t+f*F+h*N+g*B;b[4]=a*x+f*K+h*O+g*C;b[8]=a*H+f*L+h*P+g*D;b[12]=a*I+f*J+h*Q+g*e;b[1]=n*t+r*F+d*N+k*B;b[5]=n*x+r*K+d*O+k*C;b[9]=n*H+r*L+d*P+k*D;b[13]=n*I+r*J+d*Q+k*e;b[2]=l*t+q*F+m*N+u*B;b[6]=l*x+q*K+m*O+u*C;b[10]=l*H+q*L+m*P+u*D;b[14]=l*
I+q*J+m*Q+u*e;b[3]=v*t+p*F+w*N+c*B;b[7]=v*x+p*K+w*O+c*C;b[11]=v*H+p*L+w*P+c*D;b[15]=v*I+p*J+w*Q+c*e;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=new m;return function(b){for(var c=0,e=b.count;c<e;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),
determinant:function(){var a=this.elements,b=a[0],c=a[4],e=a[8],f=a[12],h=a[1],g=a[5],n=a[9],r=a[13],d=a[2],k=a[6],l=a[10],q=a[14];return a[3]*(+f*n*k-e*r*k-f*g*l+c*r*l+e*g*q-c*n*q)+a[7]*(+b*n*q-b*r*l+f*h*l-e*h*q+e*r*d-f*n*d)+a[11]*(+b*r*k-b*g*q-f*h*k+c*h*q+f*g*d-c*r*d)+a[15]*(-e*g*d-b*n*k+b*g*l+e*h*k-c*h*l+c*n*d)},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];
a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,e=a.elements;a=e[0];var f=e[1],h=e[2],g=e[3],n=e[4],d=e[5],k=e[6],l=e[7],q=e[8],m=e[9],p=e[10],u=e[11],v=e[12],z=e[13],w=e[14];e=e[15];var t=m*w*l-z*p*l+z*k*u-d*w*u-m*k*e+d*p*e,x=v*p*l-q*w*l-v*k*u+n*w*u+q*k*e-n*p*e,B=q*z*l-v*m*l+v*d*u-n*z*u-q*d*e+n*m*e,C=v*m*k-q*z*k-v*d*p+n*z*p+q*d*w-n*m*w,F=a*t+f*x+h*B+g*C;if(0===F){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");
console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/F;c[0]=t*b;c[1]=(z*p*g-m*w*g-z*h*u+f*w*u+m*h*e-f*p*e)*b;c[2]=(d*w*g-z*k*g+z*h*l-f*w*l-d*h*e+f*k*e)*b;c[3]=(m*k*g-d*p*g-m*h*l+f*p*l+d*h*u-f*k*u)*b;c[4]=x*b;c[5]=(q*w*g-v*p*g+v*h*u-a*w*u-q*h*e+a*p*e)*b;c[6]=(v*k*g-n*w*g-v*h*l+a*w*l+n*h*e-a*k*e)*b;c[7]=(n*p*g-q*k*g+q*h*l-a*p*l-n*h*u+a*k*u)*b;c[8]=B*b;c[9]=(v*m*g-q*z*g-v*f*u+a*z*u+q*f*e-a*m*e)*b;c[10]=(n*z*g-v*d*g+v*f*l-a*z*l-n*f*e+a*d*e)*b;c[11]=
(q*d*g-n*m*g-q*f*l+a*m*l+n*f*u-a*d*u)*b;c[12]=C*b;c[13]=(q*z*h-v*m*h+v*f*p-a*z*p-q*f*w+a*m*w)*b;c[14]=(v*d*h-n*z*h-v*f*k+a*z*k+n*f*w-a*d*w)*b;c[15]=(n*m*h-q*d*h+q*f*k-a*m*k-n*f*p+a*d*p)*b;return this},scale:function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],
a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=
Math.cos(b);b=Math.sin(b);var e=1-c,f=a.x,h=a.y;a=a.z;var g=e*f,d=e*h;this.set(g*f+c,g*h-b*a,g*a+b*h,0,g*h+b*a,d*h+c,d*a-b*f,0,g*a-b*h,d*a+b*f,e*a*a+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new m,b=new d;return function(c,
e,f){var h=this.elements,g=a.set(h[0],h[1],h[2]).length(),d=a.set(h[4],h[5],h[6]).length(),k=a.set(h[8],h[9],h[10]).length();0>this.determinant()&&(g=-g);c.x=h[12];c.y=h[13];c.z=h[14];b.copy(this);c=1/g;h=1/d;var l=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=h;b.elements[5]*=h;b.elements[6]*=h;b.elements[8]*=l;b.elements[9]*=l;b.elements[10]*=l;e.setFromRotationMatrix(b);f.x=g;f.y=d;f.z=k;return this}}(),makePerspective:function(a,b,c,e,f,h){void 0===h&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var g=this.elements;g[0]=2*f/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*f/(c-e);g[9]=(c+e)/(c-e);g[13]=0;g[2]=0;g[6]=0;g[10]=-(h+f)/(h-f);g[14]=-2*h*f/(h-f);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,e,f,h){var g=this.elements,d=1/(b-a),k=1/(c-e),l=1/(h-f);g[0]=2*d;g[4]=0;g[8]=0;g[12]=-((b+a)*d);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+e)*k);g[2]=0;g[6]=0;g[10]=-2*l;g[14]=-((h+f)*l);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;
a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(k,{slerp:function(a,b,c,e){return c.copy(a).slerp(b,
e)},slerpFlat:function(a,b,c,e,f,h,g){var d=c[e+0],k=c[e+1],l=c[e+2];c=c[e+3];e=f[h+0];var q=f[h+1],m=f[h+2];f=f[h+3];if(c!==f||d!==e||k!==q||l!==m){h=1-g;var p=d*e+k*q+l*m+c*f,t=0<=p?1:-1,u=1-p*p;u>Number.EPSILON&&(u=Math.sqrt(u),p=Math.atan2(u,p*t),h=Math.sin(h*p)/u,g=Math.sin(g*p)/u);t*=g;d=d*h+e*t;k=k*h+q*t;l=l*h+m*t;c=c*h+f*t;h===1-g&&(g=1/Math.sqrt(d*d+k*k+l*l+c*c),d*=g,k*=g,l*=g,c*=g)}a[b]=d;a[b+1]=k;a[b+2]=l;a[b+3]=c}});Object.defineProperties(k.prototype,{x:{get:function(){return this._x},
set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(k.prototype,{set:function(a,b,c,e){this._x=a;this._y=b;this._z=c;this._w=e;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,
this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,e=a._y,f=a._z;a=a.order;var h=Math.cos,g=Math.sin,d=h(c/2),k=h(e/2);h=h(f/2);c=g(c/2);e=g(e/2);f=g(f/2);"XYZ"===a?(this._x=c*k*h+d*e*f,this._y=d*e*h-c*k*f,this._z=d*k*f+c*e*h,this._w=d*k*h-c*e*f):"YXZ"===a?(this._x=c*k*h+
d*e*f,this._y=d*e*h-c*k*f,this._z=d*k*f-c*e*h,this._w=d*k*h+c*e*f):"ZXY"===a?(this._x=c*k*h-d*e*f,this._y=d*e*h+c*k*f,this._z=d*k*f+c*e*h,this._w=d*k*h-c*e*f):"ZYX"===a?(this._x=c*k*h-d*e*f,this._y=d*e*h+c*k*f,this._z=d*k*f-c*e*h,this._w=d*k*h+c*e*f):"YZX"===a?(this._x=c*k*h+d*e*f,this._y=d*e*h+c*k*f,this._z=d*k*f-c*e*h,this._w=d*k*h-c*e*f):"XZY"===a&&(this._x=c*k*h-d*e*f,this._y=d*e*h-c*k*f,this._z=d*k*f+c*e*h,this._w=d*k*h+c*e*f);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var e=b[8],f=b[1],h=b[5],g=b[9],d=b[2],k=b[6];b=b[10];var l=c+h+b;0<l?(c=.5/Math.sqrt(l+1),this._w=.25/c,this._x=(k-g)*c,this._y=(e-d)*c,this._z=(f-a)*c):c>h&&c>b?(c=2*Math.sqrt(1+c-h-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+f)/c,this._z=(e+d)/c):h>b?(c=2*Math.sqrt(1+h-c-b),this._w=(e-d)/c,this._x=(a+f)/c,this._y=
.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-h),this._w=(f-a)/c,this._x=(e+d)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new m,b;return function(c,e){void 0===a&&(a=new m);b=c.dot(e)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,e);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,e=a._y,f=a._z;a=a._w;var d=b._x,g=b._y,k=b._z;b=b._w;this._x=c*b+a*d+e*k-f*g;this._y=e*b+a*g+f*d-c*k;this._z=f*b+a*k+c*g-e*d;this._w=a*b-c*d-e*g-f*k;this.onChangeCallback();
return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,e=this._y,f=this._z,d=this._w,g=d*a._w+c*a._x+e*a._y+f*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=d,this._x=c,this._y=e,this._z=f,this;a=Math.sqrt(1-g*g);if(.001>Math.abs(a))return this._w=.5*(d+this._w),this._x=.5*(c+this._x),this._y=.5*(e+this._y),this._z=.5*(f+this._z),this;var k=Math.atan2(a,g);g=Math.sin((1-b)*k)/a;b=Math.sin(b*k)/a;
this._w=d*g+this._w*b;this._x=c*g+this._x*b;this._y=e*g+this._y*b;this._z=f*g+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){}});Object.defineProperties(q.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a;this.onChangeCallback()}}});Object.assign(q.prototype,{isEuler:!0,set:function(a,b,c,e){this._x=
a;this._y=b;this._z=c;this._order=e||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var e=l.clamp,f=a.elements;a=f[0];var d=f[4],g=f[8],k=f[1],q=f[5],m=f[9],p=f[2],t=f[6];f=f[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(e(g,-1,1)),.99999>Math.abs(g)?(this._x=
Math.atan2(-m,f),this._z=Math.atan2(-d,a)):(this._x=Math.atan2(t,q),this._z=0)):"YXZ"===b?(this._x=Math.asin(-e(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,f),this._z=Math.atan2(k,q)):(this._y=Math.atan2(-p,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(e(t,-1,1)),.99999>Math.abs(t)?(this._y=Math.atan2(-p,f),this._z=Math.atan2(-d,q)):(this._y=0,this._z=Math.atan2(k,a))):"ZYX"===b?(this._y=Math.asin(-e(p,-1,1)),.99999>Math.abs(p)?(this._x=Math.atan2(t,f),this._z=Math.atan2(k,a)):(this._x=0,this._z=
Math.atan2(-d,q))):"YZX"===b?(this._z=Math.asin(e(k,-1,1)),.99999>Math.abs(k)?(this._x=Math.atan2(-m,q),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(g,f))):"XZY"===b?(this._z=Math.asin(-e(d,-1,1)),.99999>Math.abs(d)?(this._x=Math.atan2(t,q),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new d;return function(b,
c,e){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,e)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new k;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,
b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new m(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});this.THREE={Euler:q,Vector3:m,Matrix3:p,Matrix4:d,Quaternion:k}}})();var B=1*Math.PI,x=2*Math.PI,t=this.AstroJS={AU2M:149597870700,AU2KM:1.495978707E8,PC2M:30856776E9,PC2AU:206265,PC2LY:3.26156,KM2M:1E3,JY2JD:365.25,
JD2SEC:86400,MSOL2KG:1.98855E30,DEG2RAD:x/360},C;for(C in t)E=C.split("2",2).reverse().join("2"),t[E]=1/t[C];t.exportConstants=function(m){for(var p in t)m[p]=t[p]};t.DMS2RAD=function(m,p,d){return(0>m?-1:1)*(Math.abs(m)+(p/60+d/60/60))*DEG2RAD};t.HMS2RAD=function(m,p,d){return 15*DMS2RAD(m,p,d)};t.PI=B;t.TAU=x;t.JD2000=2451545;var M=t.GMJD={sun:2.959122083684144E-4,mer:4.912547451450812E-11,ven:7.243452486162703E-10,ear:8.997011603631609E-10,emb:8.997011603631609E-10,mar:9.549535105779258E-11,jup:2.825345842083778E-7,
sat:8.459715185680659E-8,ura:1.2920249167819694E-8,nep:1.5243589007842763E-8,plu:2.1886997654259697E-12};E=t.GMJY={};for(C in M)E[C]=M[C],E[C]*=133407.5625;t.CYCLE=function(m){m%=x;0>m&&(m+=x);return m};t.TURN=function(m){m%=x;m>B&&(m-=x);return m};t.JD2J2K=function(m){return(m-2451545)/365.25};t.J2K2JD=function(m){return 365.25*m+2451545};t.exportConstants(this);Math.cbrt=Math.cbrt||function(m){var p=Math.pow(Math.abs(m),1/3);return 0>m?-p:p};Math.fmod=Math.fmod||function(m,p){return m%p};if("undefined"!=
typeof THREE){var D=this.Vector3=THREE.Vector3;this.Matrix3=THREE.Matrix3;this.Matrix4=THREE.Matrix4;this.Quaternion=THREE.Quaternion}"use strict";(function(m){function p(d){if(d.empty)return this;this._G=d.G||p.GMP.sun;this._t=d.epoch||d.t||0;this.translate=d.translate||null;"x"in d&&"y"in d&&"z"in d?this._r=new D(d.x,d.y,d.z):"rx"in d&&"ry"in d&&"rz"in d&&(this._r=new D(d.rx,d.ry,d.rz));"X"in d&&"Y"in d&&"Z"in d?this._v=new D(d.X,d.Y,d.Z):"vx"in d&&"vy"in d&&"vz"in d&&(this._v=new D(d.vx,d.vy,d.vz));
if("r"in d&&"v"in d){var k=d.r,l=d.v;this._r=new D(k.x,k.y,k.z);this._v=new D(l.x,l.y,l.z)}this.vectors=!(!this._r||!this._v);k="aeiMnPLcCwWOkhqpG".split("");for(var a in k)d.hasOwnProperty(k[a])&&(this["_"+k[a]]=d[k[a]]);"name"in d&&(this.name=d.name);this.lazy||(this.updateElements(),this.requireElements())}p.GMP=M;var d=p.prototype;d.clone=function(d){var k=new p({empty:!0});d&&(delete this._v,delete this._r);for(var l in this)this.hasOwnProperty(l)&&(k[l]=this[l]&&"function"==typeof this[l].clone?
this[l].clone():this[l]);d&&k.update(d);return k};d.checkElements=function(d){if(!this.elements)throw"Orbitals not calculated";if(!("_i"in this))throw"Orbit is missing inclination (i)";if(!("_e"in this))throw"Orbit is missing eccentricity (e)";if(!("_a"in this))throw"Orbit is missing semi-major axis (a)";if(!("_b"in this))throw"Orbit is missing semi-minor axis (b)";if(!("_l"in this))throw"Orbit is missing semi-latus rectum (l)";if(!("_c"in this))throw"Orbit is missing periapsis (c)";if(!("_C"in this))throw"Orbit is missing apoapsis (C)";
if(!("_L"in this))throw"Orbit is missing mean longitude (L)";if(!("_O"in this))throw"Orbit is missing right ascending node (O)";if(!("_T"in this))throw"Orbit is missing time of periapsis (w)";if(!("_t"in this))throw"Orbit is missing time of reference epoch (t)";if(!("_w"in this))throw"Orbit is missing argument of periapsis (w)";if(!("_W"in this))throw"Orbit is missing longitude of the periapsis (W)";if(!("_n"in this))throw"Orbit is missing mean motion (n)";if(!("_M"in this))throw"Orbit is missing mean anomaly (M)";
if(!("_P"in this))throw"Orbit is missing orbital period (P)";if(!("_A"in this))throw"Orbit is missing angular momentum (A)";if(!("_c"in this))throw"Orbit is missing pericenter (c)";if(!("_C"in this))throw"Orbit is missing apocenter (C)";if(0>this._e)throw"Negative eccentricity is invalid";if(1<this._e)throw"Eccentricity must not be hyperbolic (> 1)";if(1==this._e)throw"Eccentricity must not be parabolic (== 1)";if(d&&!("_m"in this))throw"Orbit is missing true anomaly (m)";if(d&&!("_B"in this))throw"Orbit is missing radial velocity (B)";
if(d&&!("_E"in this))throw"Orbit is missing eccentric anomaly (E)";};d.requireElements=function(d){this.updateElements(d);this.checkElements(d);return this};d.updateElements=function(d){if(this.elements)return this;this.elements=!0;if("_r"in this&&"_v"in this){var k=this._r,l=this._v,a=this._G,b=k.length();this._A3=k.clone().cross(l);this._A2=this._A3.lengthSq();this._A=Math.sqrt(this._A2);this._B=k.dot(l)/b;var c=this._e3=k.clone().multiplyScalar(l.lengthSq()-a/b).sub(l.clone().multiplyScalar(b*
this._B)).multiplyScalar(1/a);l=c.lengthSq();l=this._e=Math.sqrt(l);this._i=Math.acos(this._A3.z/this._A);this._l=this._A2/a;this._c=this._l/(1+l);this._C=this._l/(1-l);this._a=(this._C+this._c)/2;a=-this._A3.y;var e=+this._A3.x,f=Math.sqrt(a*a+e*e),h=0==f?0:Math.acos(a/f);this._O=0>e?x-h:h;h=a*c.x+e*c.y;this._w=0===f||0===l?0:Math.acos(h/f/l);0>c.z&&(this._w*=-1);k=0===l&&0===f?Math.acos(k.x/b):0===l?Math.acos((a*k.x+e*k.y)/(f*b)):Math.acos((c.x*k.x+c.y*k.y+c.z*k.z)/l/b);k=this._m=0>this._B?x-k:
k;if(1>l){var g=this._E=CYCLE(Math.atan2(Math.sqrt(1-l*l)*Math.sin(k),l+Math.cos(k)));this._M=g-l*Math.sin(g)}else 1<l&&(g=this._E=CYCLE(Math.atan2(Math.sqrt(1-l*l)*Math.sin(k),l+Math.cos(k))),this._M=g-l*Math.sin(g));this._M=g-l*Math.sin(g)}"_k"in this&&"_h"in this&&(this._W=Math.atan2(this._h,this._k),this._e=this._h/Math.sin(this._W));"_q"in this&&"_p"in this&&(this._O=Math.atan2(this._p,this._q),this._i=2*Math.asin((this._p-this._q)/(-Math.sqrt(2)*Math.sin(B/4-this._O))));"_n"in this&&!("_a"in
this)&&(this._a=Math.cbrt(this._G/this._n/this._n));"_P"in this&&!("_a"in this)&&(g=this._P/x,this._a=Math.cbrt(this._G*g*g));"_a"in this||("_c"in this&&"_C"in this?this._a=(this._C+this._c)/2:"_e"in this&&"_C"in this?this._a=this._C/(1+this._e):"_c"in this&&"_e"in this&&(this._a=this._c/(1-this._e)));"_e"in this||("_c"in this&&"_C"in this?this._e=1-this._c/this._a:"_a"in this&&"_C"in this?this._e=this._C/this._a-1:"_c"in this&&"_a"in this&&(this._e=1-this._c/this._a));"_e"in this?(g=1-this._e*this._e,
"_a"in this?(this._l=this._a*g,this._b=Math.sqrt(this._a*this._l)):"_b"in this?(this._a=this._b/Math.sqrt(g),this._l=this._a*g):"_l"in this&&(this._a=this._l/g,this._b=Math.sqrt(this._a*this._l))):"_a"in this?"_b"in this?(this._l=this._b*this._b/this._a,this._e=Math.sqrt(1-this._l/this._a)):"_l"in this&&(this._e=Math.sqrt(1-this._l/this._a),this._b=Math.sqrt(this._a*this._l)):"_b"in this&&"_l"in this&&(this.a=this._b*this._b/this._l,this._e=Math.sqrt(1-this._l/this._a));"_a"in this&&!("_P"in this)&&
(this._P=x/Math.sqrt(this._G)*Math.pow(this._a,1.5));"_P"in this&&!("_n"in this)&&(this._n=x/this._P);"_P"in this&&!("_A"in this)&&"_a"in this&&"_b"in this&&(this._A=x*this._a*this._b/this._P);"_a"in this&&"_e"in this&&("_c"in this||(this._c=this._a*(1-this._e)),"_C"in this||(this._C=this._a*(1+this._e)));if("_L"in this)if("_M"in this)this._W=this._L-this._M,"_O"in this?this._w=this._W-this._O:"_w"in this&&(this._O=this._W-this._w);else if("_W"in this)this._M=this._L-this._W,"_O"in this?this._w=this._W-
this._O:"_w"in this&&(this._O=this._W-this._w);else if("_O"in this&&"_w"in this)this._W=this._O+this._w,this._M=this._L-this._W;else throw"Orbit incomplete";else if("_O"in this)if("_w"in this)this._W=this._O+this._w,"_M"in this&&(this._L=this._M+this._W);else if("_W"in this)this._w=this._W-this._O,"_M"in this&&(this._L=this._M+this._W);else throw"Orbit incomplete";else"_M"in this&&"_w"in this&&"_W"in this&&(this._L=this._W+this._M,this._O=this._W-this._w);d&&this.m();"_W"in this&&(this._W=TURN(this._W));
"_L"in this&&(this._L=CYCLE(this._L));"_M"in this&&(this._M=CYCLE(this._M));"_O"in this&&(this._O=CYCLE(this._O));"_w"in this&&(this._w=TURN(this._w));"_M"in this&&(this._T=-this._M/this._n);return this};d.E=function(d){var k=this._t||0;if("_E"in this&&!d)return this._E;var l=this._e,a=this._m,b=this._M;if(!d&&null!=l&&null!=a)return this._E=CYCLE(Math.atan2(Math.sqrt(1-l*l)*Math.sin(a),l+Math.cos(a)));if(null!=l&&null!=b){d&&(b=CYCLE(this._n*(d-this._T-k)));k=.8>l?b:B;var c=1;for(a=0;1E-12<Math.abs(c)&&
12>a;++a){c=b-k+l*Math.sin(k);var e=l*Math.cos(k)-1;c/=e;k-=c}k=CYCLE(k);d||(this._E=k);return k}throw"Invalid orbital state";};d.m=function(d){if(0===arguments.length){if("_m"in this)return this._m;var k=this.E()/2;return this._m=CYCLE(2*Math.atan2(Math.sqrt(1+this._e)*Math.sin(k),Math.sqrt(1-this._e)*Math.cos(k)))}return CYCLE(2*Math.atan2(Math.sqrt(1+this._e)*Math.sin(d/2),Math.sqrt(1-this._e)*Math.cos(d/2)))};d.B=function(){if("_B"in this)return this._B;var d=this.r(),m=this.v();return this._B=
d.dot(m)/d.length()};d.e3=function(){if("_e3"in this)return this._e3;var d=this.r(),m=this.v();if(null!==d&&null!==m)return this._e3=d.clone().multiplyScalar(m.lengthSq()-this._G/d.length()).sub(m.clone().multiplyScalar(d.length()*this.B())).multiplyScalar(1/this._G)};d.i=function(){return this._i};d.e=function(){return this._e};d.a=function(){return this._a};d.b=function(){return this._b};d.l=function(){return this._l};d.C=function(){return this._C};d.c=function(){return this._c};d.L=function(){return this._L};
d.O=function(){return this._O};d.w=function(){return this._w};d.T=function(){return this._T};d.W=function(){return this._W};d.n=function(){return this._n};d.A=function(){return this._A};d.M=function(){return this._M};d.P=function(){return this._P};d.q=function(){return"_q"in this?this._q:this._q=Math.cos(this._O)*Math.sin(this._i/2)};d.p=function(){return"_p"in this?this._p:this._p=Math.sin(this._O)*Math.sin(this._i/2)};d.k=function(){return"_k"in this?this._k:this._k=this._e*Math.cos(this._W)};d.h=
function(){return"_h"in this?this._h:this._h=this._e*Math.sin(this._W)};d.update=function(d){this.elements||this.resolveElements(!0);this._M=CYCLE(this._n*(d-this._T));this._L=CYCLE(this._M+this._W);delete this._E;delete this._m;delete this._r;delete this._v;return this};d.state=function(d){var k=this._t||0;this.elements||this.resolveElements(!0);d=d||0;if(!d&&"_r"in this&&"_v"in this)return{time:d,r:this._r,v:this._v,epoch:k,orbit:this};var l=this._e,a=this._a,b=this._i,c=this._O,e=this._w,f=this.E(d),
h=this.m(f),g=a*(1-l*Math.cos(f)),m=Math.sqrt(this._G*a)/g;a=g*Math.cos(h);g*=Math.sin(h);h=m*-Math.sin(f);l=m*Math.sqrt(1-l*l)*Math.cos(f);m=Math.sin(c);var p=Math.cos(c);c=Math.sin(b);var t=Math.cos(b),A=Math.sin(e),x=Math.cos(e);e=x*p-A*m*t;b=x*m+A*p*t;f=x*m*t+A*p;m=x*p*t-A*m;p=A*c;c*=x;g=new D(a*e-g*f,a*b+g*m,a*p+g*c);a=new D(h*e-l*f,h*b+l*m,h*p+l*c);d||(this._r=g,this._v=a);return{r:g,v:a,time:d,epoch:k,orbit:this}};d.r=function(d){return this.state(d).r};d.v=function(d){return this.state(d).v};
d.inclination=d.i;d.eccentricity=d.e;d.semiMajorAxis=d.a;d.semiMinorAxis=d.b;d.semilatusRectum=d.l;d.meanLongitude=d.L;d.ascendingNode=d.O;d.argOfPericenter=d.w;d.timeOfPericenter=d.T;d.longitudeOfPericenter=d.W;d.meanMotion=d.n;d.meanAnomaly=d.M;d.orbitalPeriod=d.P;d.angularMomentum=d.A;d.trueAnomaly=d.m;d.radialVelocity=d.B;d.eccentricAnomaly=d.E;d.apoapsis=d.C;d.aphelion=d.C;d.apocenter=d.C;d.periapsis=d.c;d.perhelion=d.c;d.pericenter=d.c;d.position=d.r;d.velocity=d.v;m.Orbit=m.Orbital=p})(this);
"use strict";(function(m){function p(d){d=k(d);for(var l=JD2J2K(d)/100,m=l*l,p=m*l,F=c+e*l+f*m+h*p,N=g+n*l+r*m+t*p,q=A+x*l+B*m+C*p,L=u+v*l+z*m+w*p,K=D+E*l+H*m+I*p,y=d=0,J,M,R,G=0;G<b.length;G++)J=b[G][0]+b[G][1]*l,M=b[G][2]+b[G][3]*l,R=a[G][0]*F+a[G][1]*N+a[G][2]*q+a[G][3]*L+a[G][4]*K,d+=J*Math.sin(R),y+=M*Math.cos(R);l=(23+26/60+21.448/3600-46.815/3600*l-5.9E-4/3600*m+.001813/3600*p)*DEG2RAD;d/=36E6/DEG2RAD;y/=36E6/DEG2RAD;return{longitude:TURN(d),obliquity:TURN(y),ecliptic:CYCLE(l)}}function d(a){if(2067314.5>
a)return a=(a-2067314.5)/36525,1830-405*a+46.5*a*a;if(2067314.5<=a&&2305447.5>a)return a=(a-2396758.5)/36525,22.5*a*a;if(2312752.5<=a&&2448622.5>a){var b=Math.floor((a-2312752.5)/730.5);b>l.length-2&&(b=l.length-2);var c=l[b+1]-l[b],d=l[b+2]-l[b+1];a=(a-(2312752.5+730.5*b))/730.5;return l[b+1]+a/2*(c+d+a*(c-d))}if(2448622.5<=a&&2455197.5>=a)return b=[56.86,63.83,70],c=b[1]-b[0],d=b[2]-b[1],a=(a-2451544.5)/3652.5,b[1]+a/2*(c+d+a*(d-c));a-=2382148;return-15+a*a/41048480}function k(a){return a+d(a)/
JD2SEC}function q(a){var b=JD2J2K(a)/100;return CYCLE(F+K*(a-2451545)+L*b*b+J*b*b*b)}var l=[124,115,106,98,91,85,79,74,70,65,62,58,55,53,50,48,46,44,42,40,37,35,33,31,28,26,24,22,20,18,16,14,13,12,11,10,9,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,14,14,14,15,15,15,15,16,16,16,16,16,17,17,17,17,17,17,17,17,16,16,15,14,13.7,13.1,12.7,12.5,12.5,12.5,12.5,12.5,12.5,12.3,12,11.4,10.6,9.6,8.6,7.5,6.6,6,5.7,5.6,5.7,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.7,7.8,7.9,7.5,6.4,5.4,
2.9,1.6,-1,-2.7,-3.6,-4.7,-5.4,-5.2,-5.5,-5.6,-5.8,-5.9,-6.2,-6.4,-6.1,-4.7,-2.7,0,2.6,5.4,7.7,10.5,13.4,16,18.2,20.2,21.2,22.4,23.5,23.9,24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.2,42.2,44.5,46.5,48.5,50.5,52.2,53.8,54.9,55.8,56.9,58.3],a=[[0,0,0,0,1],[-2,0,0,2,2],[0,0,0,2,2],[0,0,0,0,2],[0,1,0,0,0],[0,0,1,0,0],[-2,1,0,2,2],[0,0,0,2,1],[0,0,1,2,2],[-2,-1,0,2,2],[-2,0,1,0,0],[-2,0,0,2,1],[0,0,-1,2,2],[2,0,0,0,0],[0,0,1,0,1],[2,0,-1,2,2],[0,0,
-1,0,1],[0,0,1,2,1],[-2,0,2,0,0],[0,0,-2,2,1],[2,0,0,2,2],[0,0,2,2,2],[0,0,2,0,0],[-2,0,1,2,2],[0,0,0,2,0],[-2,0,0,2,0],[0,0,-1,2,1],[0,2,0,0,0],[2,0,-1,0,1],[-2,2,0,2,2],[0,1,0,0,1],[-2,0,1,0,1],[0,-1,0,0,1],[0,0,2,-2,0],[2,0,-1,2,1],[2,0,1,2,2],[0,1,0,2,2],[-2,1,1,0,0],[0,-1,0,2,2],[2,0,0,2,1],[2,0,1,0,0],[-2,0,2,2,2],[-2,0,1,2,1],[2,0,-2,0,1],[2,0,0,0,1],[0,-1,1,0,0],[-2,-1,0,2,1],[-2,0,0,0,1],[0,0,2,2,1],[-2,0,2,0,1],[-2,1,0,2,1],[0,0,1,-2,0],[-1,0,1,0,0],[-2,1,0,0,0],[1,0,0,0,0],[0,0,1,2,0],
[0,0,-2,2,2],[-1,-1,1,0,0],[0,1,1,0,0],[0,-1,1,2,2],[2,-1,-1,2,2],[0,0,3,2,2],[2,-1,0,2,2]],b=[[-171996,-174.2,92025,8.9],[-13187,-1.6,5736,-3.1],[-2274,-.2,977,-.5],[2062,.2,-895,.5],[1426,-3.4,54,-.1],[712,.1,-7,0],[-517,1.2,224,-.6],[-386,-.4,200,0],[-301,0,129,-.1],[217,-.5,-95,.3],[-158,0,0,0],[129,.1,-70,0],[123,0,-53,0],[63,0,0,0],[63,.1,-33,0],[-59,0,26,0],[-58,-.1,32,0],[-51,0,27,0],[48,0,0,0],[46,0,-24,0],[-38,0,16,0],[-31,0,13,0],[29,0,0,0],[29,0,-12,0],[26,0,0,0],[-22,0,0,0],[21,0,-10,
0],[17,-.1,0,0],[16,0,-8,0],[-16,.1,7,0],[-15,0,9,0],[-13,0,7,0],[-12,0,6,0],[11,0,0,0],[-10,0,5,0],[-8,0,3,0],[7,0,-3,0],[-7,0,0,0],[-7,0,3,0],[-7,0,3,0],[6,0,0,0],[6,0,-3,0],[6,0,-3,0],[-6,0,3,0],[-6,0,3,0],[5,0,0,0],[-5,0,3,0],[-5,0,3,0],[-5,0,3,0],[4,0,0,0],[4,0,0,0],[4,0,0,0],[-4,0,0,0],[-4,0,0,0],[-4,0,0,0],[3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0]],c=297.85036*DEG2RAD,e=445267.11148*DEG2RAD,f=-.0019142*DEG2RAD,h=DEG2RAD/189474,g=357.52772*DEG2RAD,
n=35999.05034*DEG2RAD,r=-.0086972*DEG2RAD,t=-DEG2RAD/3E5,A=134.96298*DEG2RAD,x=477198.867398*DEG2RAD,B=.0086972*DEG2RAD,C=DEG2RAD/56250,u=93.27191*DEG2RAD,v=483202.017538*DEG2RAD,z=-.0036825*DEG2RAD,w=DEG2RAD/327270,D=125.04452*DEG2RAD,E=-1934.136261*DEG2RAD,H=.0020708*DEG2RAD,I=DEG2RAD/45E4,F=280.46061837*DEG2RAD,K=360.98564736629*DEG2RAD,L=3.87933E-4*DEG2RAD,J=-DEG2RAD/3871E4;m.JD2JDE=k;m.JDE2JD=function(a){return a-d(a)/JD2SEC};m.getMeanSiderealTime=q;m.getApparentSiderealTime=function(a){var b=
p(a);return q(a)+b.longitude/1*Math.cos(b.obliquity)};m.getNutation=p})(this);"use strict";(function(m){function p(){return{p:this.p,l:this.l,z:this.z}}function d(){return{x:this.x,y:this.y,z:this.z}}function k(){return{l:this.l,b:this.b,i:this.i,r:this.r}}function q(){this.r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);this.i=Math.acos(this.z/this.r);this.b=B/2-this.i;this.l=Math.atan2(this.y,this.x);return(this.sph=k).call(this)}function l(){var a=this.r*Math.sin(this.i);this.x=a*Math.cos(this.l);
this.y=a*Math.sin(this.l);this.z=this.r*Math.cos(this.i);return(this.cart=d).call(this)}function a(){this.p=Math.sqrt(this.x*this.x+this.y*this.y);this.l=Math.atan2(this.y,this.x);return(this.cyl=p).call(this)}function b(){this.x=this.p*Math.cos(this.l);this.y=this.p*Math.sin(this.l);return(this.cart=d).call(this)}function c(){this.i=Math.atan2(this.p,this.z);this.b=B/2-this.i;this.r=Math.sqrt(this.p*this.p+this.z*this.z);return(this.sph=k).call(this)}function e(){this.p=this.r*Math.cos(this.b);this.z=
this.r*Math.sin(this.b);return(this.cyl=p).call(this)}function f(f){"ra"in f&&(f.l=f.ra);"dec"in f&&(f.b=f.dec);"dist"in f&&(f.r=f.dist);"x"in f&&"y"in f&&"z"in f?(this.x=f.x,this.y=f.y,this.z=f.z,this.cart=d,this.sph=q,this.cyl=a):"p"in f&&"l"in f&&"z"in f?(this.p=f.p,this.l=f.l,this.z=f.z,this.cart=b,this.sph=c,this.cyl=p):"l"in f&&(this.l=f.l,this.r=f.r||1,"i"in f||"b"in f)&&(this.cart=l,this.sph=k,this.cyl=e,"b"in f?(this.b=f.b,this.i=B/2-this.b):"i"in f&&(this.i=f.i,this.b=B/2-this.i))}f.prototype.ecl2equ=
function(a){var b=this.cart(),c=Math.sin(a);a=Math.cos(a);return new f({x:b.x,y:b.y*a-b.z*c,z:b.z*a+b.y*c})};f.prototype.equ2ecl=function(a){var b=this.cart(),c=Math.sin(a);a=Math.cos(a);return new f({x:b.x,y:b.y*a+b.z*c,z:b.z*a-b.y*c})};var h=32.932*DEG2RAD,g=192.859508*DEG2RAD,n=27.128336*DEG2RAD;f.prototype.gal2equ=function(){var a=this.sph(),b=a.l,c=a.b;a=Math.sin(c);c=Math.cos(c);var d=Math.sin(n),e=Math.cos(n),f=c*Math.sin(b-h),k=Math.asin(a*d+f*e);return{l:CYCLE(Math.atan2(c*Math.cos(b-h),
a*e-f*d)+g),b:TURN(k)}};f.prototype.equ2gal=function(){var a=this.sph(),b=a.l,c=a.b;a=Math.sin(c);c=Math.cos(c);var d=Math.sin(n),e=Math.cos(n),f=Math.cos(g-b),k=Math.asin(a*d+c*e*f);return{l:CYCLE(h-Math.atan2(Math.sin(g-b),f*d-a/c*e)-B/2),b:TURN(k)}};var r=2306.2181*DEG2RAD,t=1.39656*DEG2RAD,x=1.39E-4*DEG2RAD,C=.30188*DEG2RAD,D=3.44E-4*DEG2RAD,E=.017998*DEG2RAD,u=1.09468*DEG2RAD,v=6.6E-5*DEG2RAD,z=.018203*DEG2RAD,w=2004.3109*DEG2RAD,M=.8533*DEG2RAD,S=.42665*DEG2RAD,H=2.17E-4*DEG2RAD,I=.041833*DEG2RAD;
f.prototype.precess=function(a,b){var c=this.l,d=this.b;var e=(a-b)/36E4;var f=e*e,g=f*e;if(e){var h=b/36E4;var k=h*h;b=(r+t*h-x*k)*e+(u+v*h)*f+z*g;a=(r+t*h-x*k)*e+(C-D*h)*f+E*g;e=(w-M*h-H*k)*e-(S+H*h)*f-I*g}else b=r*e+u*f+I*g,a=r*e+C*f+E*g,e=w*e-H*f-I*g;g=Math.cos(d);f=g*Math.cos(c+a);c=g*Math.sin(c+a);a=Math.cos(e)*f-Math.sin(e)*Math.sin(d);e=Math.sin(e)*f+Math.cos(e)*Math.sin(d);b=Math.atan2(c,a)+b;d>.4*B||d<-.4*B?(c=Math.acos(Math.sqrt(c*c+a*a)),0>d&&(c*=-1)):c=Math.asin(e);d={l:CYCLE(b),b:TURN(c)};
"r"in this&&(d.r=this.r);return d};m.Coord=f})(this)}).call(this,this);

/* crc: 9466056149403BFA68F85DB99FD01CE5 */
