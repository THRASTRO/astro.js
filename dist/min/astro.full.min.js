/* autogenerated by webmerge (compile context) */
;
/*
Astronomical Calculations (https://github.com/mgreter/astro.js)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
/* Vector3 implementation included */;
(function(V){(function(){function y(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function F(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function H(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function K(a,b,c,f){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==f?f:1}function A(a,
b,c,f){this._x=a||0;this._y=b||0;this._z=c||0;this._order=f||A.DefaultOrder}if(!this.THREE){var G={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,f;return function(){for(var g=0;36>g;g++)8===g||13===g||18===g||23===g?b[g]="-":14===g?b[g]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),f=c&15,c>>=4,b[g]=a[19===g?f&3|8:f]);return b.join("")}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,
a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,f,g){return f+(a-b)*(g-f)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*
(.5-Math.random())},degToRad:function(a){return a*G.DEG2RAD},radToDeg:function(a){return a*G.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};A.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");A.DefaultOrder="XYZ";Object.assign(y.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setScalar:function(a){this.z=
this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=
a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new K;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new K;return function(b,
c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,f=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*f;this.y=a[1]*b+a[4]*c+a[7]*f;this.z=a[2]*b+a[5]*c+a[8]*f;return this},applyMatrix4:function(a){var b=this.x,c=this.y,f=this.z;a=a.elements;var g=1/(a[3]*b+a[7]*c+a[11]*f+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*f+a[12])*g;this.y=(a[1]*b+a[5]*c+a[9]*f+a[13])*g;this.z=(a[2]*b+a[6]*c+a[10]*f+a[14])*g;return this},applyQuaternion:function(a){var b=this.x,
c=this.y,f=this.z,g=a.x,d=a.y,e=a.z;a=a.w;var h=a*b+d*f-e*c,k=a*c+e*b-g*f,l=a*f+g*c-d*b;b=-g*b-d*c-e*f;this.x=h*a+b*-g+k*-e-l*-d;this.y=k*a+b*-d+l*-g-h*-e;this.z=l*a+b*-e+h*-d-k*-g;return this},project:function(){var a=new H;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new H;return function(b){a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=
this.x,c=this.y,f=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*f;this.y=a[1]*b+a[5]*c+a[9]*f;this.z=a[2]*b+a[6]*c+a[10]*f;return this.normalize()},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,
b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a=new y,b=new y;return function(c,f){a.set(c,c,c);b.set(f,f,f);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*
a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);b=this.x;var c=this.y,f=this.z;this.x=c*a.z-f*a.y;this.y=f*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},crossVectors:function(a,b){var c=a.x,f=a.y;a=a.z;var g=b.x,d=b.y;b=b.z;this.x=f*b-a*d;this.y=a*g-c*b;this.z=c*d-f*g;return this},projectOnVector:function(a){var b=a.dot(this)/
a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new y;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new y;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(G.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=
this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},distanceToManhattan:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];
this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);
void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(F.prototype,{isMatrix3:!0,set:function(a,b,c,f,g,d,e,h,k){var l=this.elements;l[0]=a;l[1]=f;l[2]=e;l[3]=b;l[4]=g;l[5]=h;l[6]=c;l[7]=d;l[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},
copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new y;return function(b){for(var c=0,f=b.count;c<f;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,
a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,f=b.elements;b=this.elements;a=c[0];var g=c[3],d=c[6],e=c[1],h=c[4],k=c[7],l=c[2],m=c[5];c=c[8];var p=f[0],q=f[3],w=f[6],u=f[1],v=f[4],x=f[7],z=f[2],I=f[5];f=f[8];b[0]=a*p+g*u+d*z;b[3]=a*q+g*v+d*I;b[6]=a*w+g*x+d*f;b[1]=e*p+h*u+k*z;b[4]=e*q+h*v+k*I;b[7]=e*w+h*x+k*f;b[2]=l*p+m*u+c*z;b[5]=l*q+m*v+c*I;b[8]=l*w+m*x+c*f;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=
a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],f=a[2],g=a[3],d=a[4],e=a[5],h=a[6],k=a[7];a=a[8];return b*d*a-b*e*k-c*g*a+c*e*h+f*g*k-f*d*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var f=c[0],g=c[1],d=c[2],e=c[3],h=c[4],k=c[5],l=c[6],m=c[7];c=c[8];var p=c*h-k*m,q=k*l-c*e,w=m*e-h*l,u=f*p+g*q+d*w;if(0===u){if(!0===
b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/u;a[0]=p*b;a[1]=(d*m-c*g)*b;a[2]=(k*g-d*h)*b;a[3]=q*b;a[4]=(c*f-d*l)*b;a[5]=(d*e-k*f)*b;a[6]=w*b;a[7]=(g*l-m*f)*b;a[8]=(h*f-g*e)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},
transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=
c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});Object.assign(H.prototype,{isMatrix4:!0,set:function(a,b,c,f,g,d,e,h,k,l,m,p,q,w,u,v){var x=this.elements;x[0]=a;x[4]=b;x[8]=c;x[12]=f;x[1]=g;x[5]=d;x[9]=e;x[13]=h;x[2]=k;x[6]=l;x[10]=m;x[14]=p;x[3]=q;x[7]=w;x[11]=u;x[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new H).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];
b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=
new y;return function(b){var c=this.elements,f=b.elements,g=1/a.setFromMatrixColumn(b,0).length(),d=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,2).length();c[0]=f[0]*g;c[1]=f[1]*g;c[2]=f[2]*g;c[4]=f[4]*d;c[5]=f[5]*d;c[6]=f[6]*d;c[8]=f[8]*b;c[9]=f[9]*b;c[10]=f[10]*b;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,f=a.y,
g=a.z,d=Math.cos(c);c=Math.sin(c);var e=Math.cos(f);f=Math.sin(f);var h=Math.cos(g);g=Math.sin(g);if("XYZ"===a.order){a=d*h;var k=d*g,l=c*h,m=c*g;b[0]=e*h;b[4]=-e*g;b[8]=f;b[1]=k+l*f;b[5]=a-m*f;b[9]=-c*e;b[2]=m-a*f;b[6]=l+k*f;b[10]=d*e}else"YXZ"===a.order?(a=e*h,k=e*g,l=f*h,m=f*g,b[0]=a+m*c,b[4]=l*c-k,b[8]=d*f,b[1]=d*g,b[5]=d*h,b[9]=-c,b[2]=k*c-l,b[6]=m+a*c,b[10]=d*e):"ZXY"===a.order?(a=e*h,k=e*g,l=f*h,m=f*g,b[0]=a-m*c,b[4]=-d*g,b[8]=l+k*c,b[1]=k+l*c,b[5]=d*h,b[9]=m-a*c,b[2]=-d*f,b[6]=c,b[10]=d*e):
"ZYX"===a.order?(a=d*h,k=d*g,l=c*h,m=c*g,b[0]=e*h,b[4]=l*f-k,b[8]=a*f+m,b[1]=e*g,b[5]=m*f+a,b[9]=k*f-l,b[2]=-f,b[6]=c*e,b[10]=d*e):"YZX"===a.order?(a=d*e,k=d*f,l=c*e,m=c*f,b[0]=e*h,b[4]=m-a*g,b[8]=l*g+k,b[1]=g,b[5]=d*h,b[9]=-c*h,b[2]=-f*h,b[6]=k*g+l,b[10]=a-m*g):"XZY"===a.order&&(a=d*e,k=d*f,l=c*e,m=c*f,b[0]=e*h,b[4]=-g,b[8]=f*h,b[1]=a*g+m,b[5]=d*h,b[9]=k*g-l,b[2]=l*g-k,b[6]=c*h,b[10]=m*g+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(a){var b=
this.elements,c=a._x,f=a._y,g=a._z,d=a._w,e=c+c,h=f+f,k=g+g;a=c*e;var l=c*h;c*=k;var m=f*h;f*=k;g*=k;e*=d;h*=d;d*=k;b[0]=1-(m+g);b[4]=l-d;b[8]=c+h;b[1]=l+d;b[5]=1-(a+g);b[9]=f-e;b[2]=c-h;b[6]=f+e;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new y,b=new y,c=new y;return function(f,g,d){var e=this.elements;c.subVectors(f,g);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(d,c);0===a.lengthSq()&&(1===Math.abs(d.z)?c.x+=1E-4:c.z+=1E-4,
c.normalize(),a.crossVectors(d,c));a.normalize();b.crossVectors(c,a);e[0]=a.x;e[4]=b.x;e[8]=c.x;e[1]=a.y;e[5]=b.y;e[9]=c.y;e[2]=a.z;e[6]=b.z;e[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,f=b.elements;
b=this.elements;a=c[0];var g=c[4],d=c[8],e=c[12],h=c[1],k=c[5],l=c[9],m=c[13],p=c[2],q=c[6],w=c[10],u=c[14],v=c[3],x=c[7],z=c[11];c=c[15];var I=f[0],O=f[4],L=f[8],M=f[12],n=f[1],D=f[5],B=f[9],r=f[13],t=f[2],C=f[6],E=f[10],P=f[14],S=f[3],W=f[7],X=f[11];f=f[15];b[0]=a*I+g*n+d*t+e*S;b[4]=a*O+g*D+d*C+e*W;b[8]=a*L+g*B+d*E+e*X;b[12]=a*M+g*r+d*P+e*f;b[1]=h*I+k*n+l*t+m*S;b[5]=h*O+k*D+l*C+m*W;b[9]=h*L+k*B+l*E+m*X;b[13]=h*M+k*r+l*P+m*f;b[2]=p*I+q*n+w*t+u*S;b[6]=p*O+q*D+w*C+u*W;b[10]=p*L+q*B+w*E+u*X;b[14]=p*
M+q*r+w*P+u*f;b[3]=v*I+x*n+z*t+c*S;b[7]=v*O+x*D+z*C+c*W;b[11]=v*L+x*B+z*E+c*X;b[15]=v*M+x*r+z*P+c*f;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=new y;return function(b){for(var c=0,f=b.count;c<f;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),
determinant:function(){var a=this.elements,b=a[0],c=a[4],f=a[8],g=a[12],d=a[1],e=a[5],h=a[9],k=a[13],l=a[2],m=a[6],p=a[10],q=a[14];return a[3]*(+g*h*m-f*k*m-g*e*p+c*k*p+f*e*q-c*h*q)+a[7]*(+b*h*q-b*k*p+g*d*p-f*d*q+f*k*l-g*h*l)+a[11]*(+b*k*m-b*e*q-g*d*m+c*d*q+g*e*l-c*k*l)+a[15]*(-f*e*l-b*h*m+b*e*p+f*d*m-c*d*p+c*h*l)},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];
a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,f=a.elements;a=f[0];var g=f[1],d=f[2],e=f[3],h=f[4],k=f[5],l=f[6],m=f[7],p=f[8],q=f[9],w=f[10],u=f[11],v=f[12],x=f[13],z=f[14];f=f[15];var I=q*z*m-x*w*m+x*l*u-k*z*u-q*l*f+k*w*f,O=v*w*m-p*z*m-v*l*u+h*z*u+p*l*f-h*w*f,L=p*x*m-v*q*m+v*k*u-h*x*u-p*k*f+h*q*f,M=v*q*l-p*x*l-v*k*w+h*x*w+p*k*z-h*q*z,n=a*I+g*O+d*L+e*M;if(0===n){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");
console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/n;c[0]=I*b;c[1]=(x*w*e-q*z*e-x*d*u+g*z*u+q*d*f-g*w*f)*b;c[2]=(k*z*e-x*l*e+x*d*m-g*z*m-k*d*f+g*l*f)*b;c[3]=(q*l*e-k*w*e-q*d*m+g*w*m+k*d*u-g*l*u)*b;c[4]=O*b;c[5]=(p*z*e-v*w*e+v*d*u-a*z*u-p*d*f+a*w*f)*b;c[6]=(v*l*e-h*z*e-v*d*m+a*z*m+h*d*f-a*l*f)*b;c[7]=(h*w*e-p*l*e+p*d*m-a*w*m-h*d*u+a*l*u)*b;c[8]=L*b;c[9]=(v*q*e-p*x*e-v*g*u+a*x*u+p*g*f-a*q*f)*b;c[10]=(h*x*e-v*k*e+v*g*m-a*x*m-h*g*f+a*k*f)*b;c[11]=
(p*k*e-h*q*e-p*g*m+a*q*m+h*g*u-a*k*u)*b;c[12]=M*b;c[13]=(p*x*d-v*q*d+v*g*w-a*x*w-p*g*z+a*q*z)*b;c[14]=(v*k*d-h*x*d-v*g*l+a*x*l+h*g*z-a*k*z)*b;c[15]=(h*q*d-p*k*d+p*g*l-a*q*l-h*g*w+a*k*w)*b;return this},scale:function(a){var b=this.elements,c=a.x,f=a.y;a=a.z;b[0]*=c;b[4]*=f;b[8]*=a;b[1]*=c;b[5]*=f;b[9]*=a;b[2]*=c;b[6]*=f;b[10]*=a;b[3]*=c;b[7]*=f;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],
a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=
Math.cos(b);b=Math.sin(b);var f=1-c,g=a.x,d=a.y;a=a.z;var e=f*g,h=f*d;this.set(e*g+c,e*d-b*a,e*a+b*d,0,e*d+b*a,h*d+c,h*a-b*g,0,e*a-b*d,h*a+b*g,f*a*a+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new y,b=new H;return function(c,
f,g){var d=this.elements,e=a.set(d[0],d[1],d[2]).length(),h=a.set(d[4],d[5],d[6]).length(),k=a.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e);c.x=d[12];c.y=d[13];c.z=d[14];b.copy(this);c=1/e;d=1/h;var l=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=d;b.elements[5]*=d;b.elements[6]*=d;b.elements[8]*=l;b.elements[9]*=l;b.elements[10]*=l;f.setFromRotationMatrix(b);g.x=e;g.y=h;g.z=k;return this}}(),makePerspective:function(a,b,c,f,g,d){void 0===d&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var e=this.elements;e[0]=2*g/(b-a);e[4]=0;e[8]=(b+a)/(b-a);e[12]=0;e[1]=0;e[5]=2*g/(c-f);e[9]=(c+f)/(c-f);e[13]=0;e[2]=0;e[6]=0;e[10]=-(d+g)/(d-g);e[14]=-2*d*g/(d-g);e[3]=0;e[7]=0;e[11]=-1;e[15]=0;return this},makeOrthographic:function(a,b,c,f,g,d){var e=this.elements,h=1/(b-a),k=1/(c-f),l=1/(d-g);e[0]=2*h;e[4]=0;e[8]=0;e[12]=-((b+a)*h);e[1]=0;e[5]=2*k;e[9]=0;e[13]=-((c+f)*k);e[2]=0;e[6]=0;e[10]=-2*l;e[14]=-((d+g)*l);e[3]=0;e[7]=0;e[11]=0;e[15]=1;return this},equals:function(a){var b=this.elements;
a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(K,{slerp:function(a,b,c,f){return c.copy(a).slerp(b,
f)},slerpFlat:function(a,b,c,f,g,d,e){var h=c[f+0],k=c[f+1],l=c[f+2];c=c[f+3];f=g[d+0];var m=g[d+1],p=g[d+2];g=g[d+3];if(c!==g||h!==f||k!==m||l!==p){d=1-e;var q=h*f+k*m+l*p+c*g,w=0<=q?1:-1,u=1-q*q;u>Number.EPSILON&&(u=Math.sqrt(u),q=Math.atan2(u,q*w),d=Math.sin(d*q)/u,e=Math.sin(e*q)/u);w*=e;h=h*d+f*w;k=k*d+m*w;l=l*d+p*w;c=c*d+g*w;d===1-e&&(e=1/Math.sqrt(h*h+k*k+l*l+c*c),h*=e,k*=e,l*=e,c*=e)}a[b]=h;a[b+1]=k;a[b+2]=l;a[b+3]=c}});Object.defineProperties(K.prototype,{x:{get:function(){return this._x},
set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(K.prototype,{set:function(a,b,c,f){this._x=a;this._y=b;this._z=c;this._w=f;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,
this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,f=a._y,g=a._z;a=a.order;var d=Math.cos,e=Math.sin,h=d(c/2),k=d(f/2);d=d(g/2);c=e(c/2);f=e(f/2);g=e(g/2);"XYZ"===a?(this._x=c*k*d+h*f*g,this._y=h*f*d-c*k*g,this._z=h*k*g+c*f*d,this._w=h*k*d-c*f*g):"YXZ"===a?(this._x=c*k*d+
h*f*g,this._y=h*f*d-c*k*g,this._z=h*k*g-c*f*d,this._w=h*k*d+c*f*g):"ZXY"===a?(this._x=c*k*d-h*f*g,this._y=h*f*d+c*k*g,this._z=h*k*g+c*f*d,this._w=h*k*d-c*f*g):"ZYX"===a?(this._x=c*k*d-h*f*g,this._y=h*f*d+c*k*g,this._z=h*k*g-c*f*d,this._w=h*k*d+c*f*g):"YZX"===a?(this._x=c*k*d+h*f*g,this._y=h*f*d+c*k*g,this._z=h*k*g-c*f*d,this._w=h*k*d-c*f*g):"XZY"===a&&(this._x=c*k*d-h*f*g,this._y=h*f*d-c*k*g,this._z=h*k*g+c*f*d,this._w=h*k*d+c*f*g);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var f=b[8],g=b[1],d=b[5],e=b[9],h=b[2],k=b[6];b=b[10];var l=c+d+b;0<l?(c=.5/Math.sqrt(l+1),this._w=.25/c,this._x=(k-e)*c,this._y=(f-h)*c,this._z=(g-a)*c):c>d&&c>b?(c=2*Math.sqrt(1+c-d-b),this._w=(k-e)/c,this._x=.25*c,this._y=(a+g)/c,this._z=(f+h)/c):d>b?(c=2*Math.sqrt(1+d-c-b),this._w=(f-h)/c,this._x=(a+g)/c,this._y=
.25*c,this._z=(e+k)/c):(c=2*Math.sqrt(1+b-c-d),this._w=(g-a)/c,this._x=(f+h)/c,this._y=(e+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new y,b;return function(c,f){void 0===a&&(a=new y);b=c.dot(f)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,f);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,f=a._y,g=a._z;a=a._w;var d=b._x,e=b._y,h=b._z;b=b._w;this._x=c*b+a*d+f*h-g*e;this._y=f*b+a*e+g*d-c*h;this._z=g*b+a*h+c*e-f*d;this._w=a*b-c*d-f*e-g*h;this.onChangeCallback();
return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,f=this._y,g=this._z,d=this._w,e=d*a._w+c*a._x+f*a._y+g*a._z;0>e?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,e=-e):this.copy(a);if(1<=e)return this._w=d,this._x=c,this._y=f,this._z=g,this;a=Math.sqrt(1-e*e);if(.001>Math.abs(a))return this._w=.5*(d+this._w),this._x=.5*(c+this._x),this._y=.5*(f+this._y),this._z=.5*(g+this._z),this;var h=Math.atan2(a,e);e=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;
this._w=d*e+this._w*b;this._x=c*e+this._x*b;this._y=f*e+this._y*b;this._z=g*e+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){}});Object.defineProperties(A.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a;this.onChangeCallback()}}});Object.assign(A.prototype,{isEuler:!0,set:function(a,b,c,f){this._x=
a;this._y=b;this._z=c;this._order=f||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var f=G.clamp,g=a.elements;a=g[0];var d=g[4],e=g[8],h=g[1],k=g[5],l=g[9],m=g[2],p=g[6];g=g[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(f(e,-1,1)),.99999>Math.abs(e)?(this._x=
Math.atan2(-l,g),this._z=Math.atan2(-d,a)):(this._x=Math.atan2(p,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-f(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(e,g),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-m,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(f(p,-1,1)),.99999>Math.abs(p)?(this._y=Math.atan2(-m,g),this._z=Math.atan2(-d,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-f(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(p,g),this._z=Math.atan2(h,a)):(this._x=0,this._z=
Math.atan2(-d,k))):"YZX"===b?(this._z=Math.asin(f(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(e,g))):"XZY"===b?(this._z=Math.asin(-f(d,-1,1)),.99999>Math.abs(d)?(this._x=Math.atan2(p,k),this._y=Math.atan2(e,a)):(this._x=Math.atan2(-l,g),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new H;return function(b,
c,f){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,f)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new K;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,
b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new y(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});this.THREE={Euler:A,Vector3:y,Matrix3:F,Matrix4:H,Quaternion:K}}})();var Q=1*Math.PI,N=2*Math.PI,J=this.AstroJS={AU2M:149597870700,AU2KM:1.495978707E8,PC2M:30856776E9,PC2AU:206265,PC2LY:3.26156,KM2M:1E3,JY2JD:365.25,
JD2SEC:86400,MSOL2KG:1.98855E30,DEG2RAD:N/360},T;for(T in J)V=T.split("2",2).reverse().join("2"),J[V]=1/J[T];J.exportConstants=function(y){for(var F in J)y[F]=J[F]};J.DMS2RAD=function(y,F,H){return(0>y?-1:1)*(Math.abs(y)+(F/60+H/60/60))*DEG2RAD};J.HMS2RAD=function(y,F,H){return 15*DMS2RAD(y,F,H)};J.PI=Q;J.TAU=N;J.JD2000=2451545;var Y=J.GMJD={sun:2.959122083684144E-4,mer:4.912547451450812E-11,ven:7.243452486162703E-10,ear:8.997011603631609E-10,emb:8.997011603631609E-10,mar:9.549535105779258E-11,jup:2.825345842083778E-7,
sat:8.459715185680659E-8,ura:1.2920249167819694E-8,nep:1.5243589007842763E-8,plu:2.1886997654259697E-12};V=J.GMJY={};for(T in Y)V[T]=Y[T],V[T]*=133407.5625;J.CYCLE=function(y){y%=N;0>y&&(y+=N);return y};J.TURN=function(y){y%=N;y>Q&&(y-=N);return y};J.JDtoJY2K=function(y){return(y-2451545)/365.25};J.JY2KtoJD=function(y){return 365.25*y+2451545};J.exportConstants(this);Math.cbrt=Math.cbrt||function(y){var F=Math.pow(Math.abs(y),1/3);return 0>y?-F:F};Math.fmod=Math.fmod||function(y,F){return y%F};if("undefined"!=
typeof THREE){var U=this.Vector3=THREE.Vector3;this.Matrix3=THREE.Matrix3;this.Matrix4=THREE.Matrix4;this.Quaternion=THREE.Quaternion}"use strict";(function(y){function F(e){if(e.empty)return this;"G"in e&&console.warn("G has been renamed to GM");this._GM=e.GM||e.G||F.GMP.sun;this._t=e.epoch||e.t||0;this.translate=e.translate||null;"x"in e&&"y"in e&&"z"in e?this._r=new U(e.x,e.y,e.z):"rx"in e&&"ry"in e&&"rz"in e&&(this._r=new U(e.rx,e.ry,e.rz));"X"in e&&"Y"in e&&"Z"in e?this._v=new U(e.X,e.Y,e.Z):
"vx"in e&&"vy"in e&&"vz"in e&&(this._v=new U(e.vx,e.vy,e.vz));if("r"in e&&"v"in e){var h=e.r,k=e.v;this._r=new U(h.x,h.y,h.z);this._v=new U(k.x,k.y,k.z)}this.vectors=!(!this._r||!this._v);h="aeiMnPLcCwWOkhqpG".split("");for(var l in h)e.hasOwnProperty(h[l])&&(this["_"+h[l]]=e[h[l]]);this._PW=e.PW||0;this._PO=e.PO||0;"name"in e&&(this.name=e.name);this.lazy||(this.updateElements(),this.requireElements())}var H=Math.abs,K=Math.pow,A=Math.sin,G=Math.cos,a=Math.sqrt,b=Math.cbrt,c=Math.atan2,f=Math.asin,
g=Math.acos;F.GMP=Y;var d=F.prototype;d.clone=function(e){var h=this._t||0;h=null==e?0:e-h;var k=new F({empty:!0});h&&(delete this._v,delete this._r);for(var l in this)this.hasOwnProperty(l)&&(k[l]=this[l]&&"function"==typeof this[l].clone?this[l].clone():this[l]);h&&k._update(e);return k};d.checkElements=function(e){if(!this.elements)throw"Orbitals not calculated";if(!("_i"in this))throw"Orbit is missing inclination (i)";if(!("_e"in this))throw"Orbit is missing eccentricity (e)";if(!("_a"in this))throw"Orbit is missing semi-major axis (a)";
if(!("_b"in this))throw"Orbit is missing semi-minor axis (b)";if(!("_l"in this))throw"Orbit is missing semi-latus rectum (l)";if(!("_c"in this))throw"Orbit is missing periapsis (c)";if(!("_C"in this))throw"Orbit is missing apoapsis (C)";if(!("_L"in this))throw"Orbit is missing mean longitude (L)";if(!("_O"in this))throw"Orbit is missing right ascending node (O)";if(!("_T"in this))throw"Orbit is missing time of periapsis (w)";if(!("_t"in this))throw"Orbit is missing time of reference epoch (t)";if(!("_w"in
this))throw"Orbit is missing argument of periapsis (w)";if(!("_W"in this))throw"Orbit is missing longitude of the periapsis (W)";if(!("_n"in this))throw"Orbit is missing mean motion (n)";if(!("_M"in this))throw"Orbit is missing mean anomaly (M)";if(!("_P"in this))throw"Orbit is missing orbital period (P)";if(!("_A"in this))throw"Orbit is missing angular momentum (A)";if(!("_c"in this))throw"Orbit is missing pericenter (c)";if(!("_C"in this))throw"Orbit is missing apocenter (C)";if(0>this._e)throw"Negative eccentricity is invalid";
if(1<this._e)throw"Eccentricity must not be hyperbolic (> 1)";if(1==this._e)throw"Eccentricity must not be parabolic (== 1)";if(e&&!("_m"in this))throw"Orbit is missing true anomaly (m)";if(e&&!("_B"in this))throw"Orbit is missing radial velocity (B)";if(e&&!("_E"in this))throw"Orbit is missing eccentric anomaly (E)";};d.requireElements=function(e){this.updateElements(e);this.checkElements(e);return this};d.updateElements=function(e){if(this.elements)return this;this.elements=!0;if("_r"in this&&"_v"in
this){var h=this._r,k=this._v,l=this._GM,m=h.length();this._A3=h.clone().cross(k);this._A2=this._A3.lengthSq();this._A=a(this._A2);this._B=h.dot(k)/m;var p=this._e3=h.clone().multiplyScalar(k.lengthSq()-l/m).sub(k.clone().multiplyScalar(m*this._B)).multiplyScalar(1/l);k=p.lengthSq();k=this._e=a(k);this._i=g(this._A3.z/this._A);this._l=this._A2/l;this._c=this._l/(1+k);this._C=this._l/(1-k);this._a=(this._C+this._c)/2;l=-this._A3.y;var q=+this._A3.x,w=a(l*l+q*q),u=0==w?0:g(l/w);this._O=0>q?N-u:u;u=
l*p.x+q*p.y;this._w=0===w||0===k?0:g(u/w/k);0>p.z&&(this._w*=-1);h=0===k&&0===w?g(h.x/m):0===k?g((l*h.x+q*h.y)/(w*m)):g((p.x*h.x+p.y*h.y+p.z*h.z)/k/m);h=this._m=0>this._B?N-h:h;if(1>k){var v=this._E=CYCLE(c(a(1-k*k)*A(h),k+G(h)));this._M=v-k*A(v)}else 1<k&&(v=this._E=CYCLE(c(a(1-k*k)*A(h),k+G(h))),this._M=v-k*A(v));this._M=v-k*A(v)}"_k"in this&&"_h"in this&&(this._W=c(this._h,this._k),this._e=this._h/A(this._W));"_q"in this&&"_p"in this&&(this._O=c(this._p,this._q),v=this._p-this._q,h=-a(2)*A(Q/4-
this._O),this._i=2*f(v/h));"_n"in this&&!("_a"in this)&&(this._a=b(this._GM/this._n/this._n));"_P"in this&&!("_a"in this)&&(v=this._P/N,this._a=b(this._GM*v*v));"_a"in this||("_c"in this&&"_C"in this?this._a=(this._C+this._c)/2:"_e"in this&&"_C"in this?this._a=this._C/(1+this._e):"_c"in this&&"_e"in this&&(this._a=this._c/(1-this._e)));"_e"in this||("_c"in this&&"_C"in this?this._e=1-this._c/this._a:"_a"in this&&"_C"in this?this._e=this._C/this._a-1:"_c"in this&&"_a"in this&&(this._e=1-this._c/this._a));
"_e"in this?(v=1-this._e*this._e,"_a"in this?(this._l=this._a*v,this._b=a(this._a*this._l)):"_b"in this?(this._a=this._b/a(v),this._l=this._a*v):"_l"in this&&(this._a=this._l/v,this._b=a(this._a*this._l))):"_a"in this?"_b"in this?(this._l=this._b*this._b/this._a,this._e=a(1-this._l/this._a)):"_l"in this&&(this._e=a(1-this._l/this._a),this._b=a(this._a*this._l)):"_b"in this&&"_l"in this&&(this.a=this._b*this._b/this._l,this._e=a(1-this._l/this._a));"_a"in this&&!("_P"in this)&&(this._P=N/a(this._GM)*
K(this._a,1.5));"_P"in this&&!("_n"in this)&&(this._n=N/this._P);"_P"in this&&!("_A"in this)&&"_a"in this&&"_b"in this&&(this._A=N*this._a*this._b/this._P);"_a"in this&&"_e"in this&&("_c"in this||(this._c=this._a*(1-this._e)),"_C"in this||(this._C=this._a*(1+this._e)));if("_L"in this)if("_M"in this)this._W=this._L-this._M,"_O"in this?this._w=this._W-this._O:"_w"in this&&(this._O=this._W-this._w);else if("_W"in this)this._M=this._L-this._W,"_O"in this?this._w=this._W-this._O:"_w"in this&&(this._O=
this._W-this._w);else if("_O"in this&&"_w"in this)this._W=this._O+this._w,this._M=this._L-this._W;else throw"Orbit incomplete";else if("_O"in this)if("_w"in this)this._W=this._O+this._w,"_M"in this&&(this._L=this._M+this._W);else if("_W"in this)this._w=this._W-this._O,"_M"in this&&(this._L=this._M+this._W);else throw"Orbit incomplete";else"_M"in this&&"_w"in this&&"_W"in this&&(this._L=this._W+this._M,this._O=this._W-this._w);e&&this.m();"_W"in this&&(this._W=TURN(this._W));"_L"in this&&(this._L=
CYCLE(this._L));"_M"in this&&(this._M=CYCLE(this._M));"_O"in this&&(this._O=CYCLE(this._O));"_w"in this&&(this._w=TURN(this._w));"_M"in this&&(this._T=-this._M/this._n);return this};d.E=function(e){var h=this._t||0;e=null==e?0:e-h;if("_E"in this&&!e)return this._E;h=this._e;var k=this._m,l=this._M;if(!e&&null!=h&&null!=k)return this._E=CYCLE(c(a(1-h*h)*A(k),h+G(k)));if(null!=h&&null!=l){e&&(l+=CYCLE(this._n*e));k=.8>h?l:Q;var m=1;for(var p=0;1E-12<H(m)&&12>p;++p){m=l-k+h*A(k);var q=h*G(k)-1;m/=q;
k-=m}k=CYCLE(k);e||(this._E=k);return k}throw"Invalid orbital state";};d.m=function(e){if(0===arguments.length){if("_m"in this)return this._m;var h=this.E()/2;return this._m=CYCLE(2*c(a(1+this._e)*A(h),a(1-this._e)*G(h)))}return CYCLE(2*c(a(1+this._e)*A(e/2),a(1-this._e)*G(e/2)))};d.B=function(){if("_B"in this)return this._B;var e=this.r(),h=this.v();return this._B=e.dot(h)/e.length()};d.e3=function(){if("_e3"in this)return this._e3;var e=this.r(),h=this.v();if(null!==e&&null!==h)return this._e3=
e.clone().multiplyScalar(h.lengthSq()-this._GM/e.length()).sub(h.clone().multiplyScalar(e.length()*this.B())).multiplyScalar(1/this._GM)};d.i=function(){return this._i};d.e=function(){return this._e};d.a=function(){return this._a};d.b=function(){return this._b};d.l=function(){return this._l};d.C=function(){return this._C};d.c=function(){return this._c};d.L=function(){return this._L};d.O=function(){return this._O};d.w=function(){return this._w};d.T=function(){return this._T};d.W=function(){return this._W};
d.n=function(){return this._n};d.A=function(){return this._A};d.M=function(){return this._M};d.P=function(){return this._P};d.GM=function(){return this._GM};d.PW=function(){return this._PW};d.PO=function(){return this._PO};d.epoch=function(){return this._t};d.q=function(){return"_q"in this?this._q:this._q=G(this._O)*A(this._i/2)};d.p=function(){return"_p"in this?this._p:this._p=A(this._O)*A(this._i/2)};d.k=function(){return"_k"in this?this._k:this._k=this._e*G(this._W)};d.h=function(){return"_h"in
this?this._h:this._h=this._e*A(this._W)};d._update=function(e){var h=this._t||0;e=null==e?0:e-h;this.elements||this.resolveElements(!0);this._M=CYCLE(this._n*(e-this._T));this._L=CYCLE(this._M+this._W);this._PW&&(this._w=e/this._PW*N);this._PO&&(this._O+=e/this._PO*N);this._t=e+h;delete this._E;delete this._m;delete this._r;delete this._v;return this};d.state=function(e){var h=this._t||0,k=null==e?0:e-h;this.elements||this.resolveElements(!0);if(!k&&"_r"in this&&"_v"in this)return{r:this._r,v:this._v,
epoch:h,orbit:this,GM:this._GM};var l=this._e,m=this._a,p=this._i,q=this._O,w=this._w,u=this.E(e);e=this.m(u);this._PW&&(w+=k/this._PW*N);this._PO&&(q+=k/this._PO*N);var v=m*(1-l*G(u)),x=a(this._GM*m)/v;m=v*G(e);v*=A(e);e=x*-A(u);l=x*a(1-l*l)*G(u);u=A(q);var z=G(q);q=A(p);var I=G(p);x=A(w);var O=G(w),L=O*z,M=O*u;p=x*I;w=L-p*u;p=M+p*z;z=M*I+x*z;u=L*I-x*u;x*=q;q*=O;v=new U(m*w-v*z,m*p+v*u,m*x+v*q);m=new U(e*w-l*z,e*p+l*u,e*x+l*q);k||(this._r=v,this._v=m);return{r:v,v:m,epoch:h,orbit:this,GM:this._GM}};
d.r=function(e){return this.state(e).r};d.v=function(e){return this.state(e).v};d.inclination=d.i;d.eccentricity=d.e;d.semiMajorAxis=d.a;d.semiMinorAxis=d.b;d.semilatusRectum=d.l;d.meanLongitude=d.L;d.ascendingNode=d.O;d.argOfPericenter=d.w;d.argOfPeriapsis=d.w;d.timeOfPericenter=d.T;d.longitudeOfPericenter=d.W;d.meanMotion=d.n;d.meanAnomaly=d.M;d.orbitalPeriod=d.P;d.angularMomentum=d.A;d.gravitationalParameter=d.GM;d.apsidalPrecession=d.PW;d.nodalPrecession=d.PO;d.trueAnomaly=d.m;d.radialVelocity=
d.B;d.eccentricAnomaly=d.E;d.apoapsis=d.C;d.aphelion=d.C;d.apocenter=d.C;d.periapsis=d.c;d.perhelion=d.c;d.pericenter=d.c;d.position=d.r;d.velocity=d.v;y.Orbit=y.Orbital=F})(this);"use strict";(function(y){function F(r){r=JD2toJDE(r);for(var t=JDtoJY2K(r)/100,C=t*t,E=C*t,P=b+c*t+f*C+g*E,S=d+e*t+h*C+k*E,W=l+m*t+p*C+q*E,X=w+u*t+v*C+x*E,da=z+I*t+O*C+L*E,Z=r=0,ba,ca,aa,R=0;R<a.length;R++)ba=a[R][0]+a[R][1]*t,ca=a[R][2]+a[R][3]*t,aa=G[R][0]*P+G[R][1]*S+G[R][2]*W+G[R][3]*X+G[R][4]*da,r+=ba*Math.sin(aa),
Z+=ca*Math.cos(aa);t=(23+26/60+21.448/3600-46.815/3600*t-5.9E-4/3600*C+.001813/3600*E)*DEG2RAD;r/=36E6/DEG2RAD;Z/=36E6/DEG2RAD;return{longitude:TURN(r),obliquity:TURN(Z),ecliptic:CYCLE(t)}}function H(r){if(2067314.5>r)return r=(r-2067314.5)/36525,1830-405*r+46.5*r*r;if(2067314.5<=r&&2305447.5>r)return r=(r-2396758.5)/36525,22.5*r*r;if(2312752.5<=r&&2448622.5>r){var t=Math.floor((r-2312752.5)/730.5);t>A.length-2&&(t=A.length-2);var C=A[t+1]-A[t],E=A[t+2]-A[t+1];r=(r-(2312752.5+730.5*t))/730.5;return A[t+
1]+r/2*(C+E+r*(C-E))}if(2448622.5<=r&&2455197.5>=r)return t=[56.86,63.83,70],C=t[1]-t[0],E=t[2]-t[1],r=(r-2451544.5)/3652.5,t[1]+r/2*(C+E+r*(E-C));r-=2382148;return-15+r*r/41048480}function K(r){var t=JDtoJY2K(r)/100;return CYCLE(M+n*(r-2451545)+D*t*t+B*t*t*t)}var A=[124,115,106,98,91,85,79,74,70,65,62,58,55,53,50,48,46,44,42,40,37,35,33,31,28,26,24,22,20,18,16,14,13,12,11,10,9,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,14,14,14,15,15,15,15,16,16,16,16,16,17,17,
17,17,17,17,17,17,16,16,15,14,13.7,13.1,12.7,12.5,12.5,12.5,12.5,12.5,12.5,12.3,12,11.4,10.6,9.6,8.6,7.5,6.6,6,5.7,5.6,5.7,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.7,7.8,7.9,7.5,6.4,5.4,2.9,1.6,-1,-2.7,-3.6,-4.7,-5.4,-5.2,-5.5,-5.6,-5.8,-5.9,-6.2,-6.4,-6.1,-4.7,-2.7,0,2.6,5.4,7.7,10.5,13.4,16,18.2,20.2,21.2,22.4,23.5,23.9,24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.2,42.2,44.5,46.5,48.5,50.5,52.2,53.8,54.9,55.8,56.9,58.3],G=[[0,0,0,0,1],[-2,0,0,2,2],[0,0,
0,2,2],[0,0,0,0,2],[0,1,0,0,0],[0,0,1,0,0],[-2,1,0,2,2],[0,0,0,2,1],[0,0,1,2,2],[-2,-1,0,2,2],[-2,0,1,0,0],[-2,0,0,2,1],[0,0,-1,2,2],[2,0,0,0,0],[0,0,1,0,1],[2,0,-1,2,2],[0,0,-1,0,1],[0,0,1,2,1],[-2,0,2,0,0],[0,0,-2,2,1],[2,0,0,2,2],[0,0,2,2,2],[0,0,2,0,0],[-2,0,1,2,2],[0,0,0,2,0],[-2,0,0,2,0],[0,0,-1,2,1],[0,2,0,0,0],[2,0,-1,0,1],[-2,2,0,2,2],[0,1,0,0,1],[-2,0,1,0,1],[0,-1,0,0,1],[0,0,2,-2,0],[2,0,-1,2,1],[2,0,1,2,2],[0,1,0,2,2],[-2,1,1,0,0],[0,-1,0,2,2],[2,0,0,2,1],[2,0,1,0,0],[-2,0,2,2,2],[-2,
0,1,2,1],[2,0,-2,0,1],[2,0,0,0,1],[0,-1,1,0,0],[-2,-1,0,2,1],[-2,0,0,0,1],[0,0,2,2,1],[-2,0,2,0,1],[-2,1,0,2,1],[0,0,1,-2,0],[-1,0,1,0,0],[-2,1,0,0,0],[1,0,0,0,0],[0,0,1,2,0],[0,0,-2,2,2],[-1,-1,1,0,0],[0,1,1,0,0],[0,-1,1,2,2],[2,-1,-1,2,2],[0,0,3,2,2],[2,-1,0,2,2]],a=[[-171996,-174.2,92025,8.9],[-13187,-1.6,5736,-3.1],[-2274,-.2,977,-.5],[2062,.2,-895,.5],[1426,-3.4,54,-.1],[712,.1,-7,0],[-517,1.2,224,-.6],[-386,-.4,200,0],[-301,0,129,-.1],[217,-.5,-95,.3],[-158,0,0,0],[129,.1,-70,0],[123,0,-53,
0],[63,0,0,0],[63,.1,-33,0],[-59,0,26,0],[-58,-.1,32,0],[-51,0,27,0],[48,0,0,0],[46,0,-24,0],[-38,0,16,0],[-31,0,13,0],[29,0,0,0],[29,0,-12,0],[26,0,0,0],[-22,0,0,0],[21,0,-10,0],[17,-.1,0,0],[16,0,-8,0],[-16,.1,7,0],[-15,0,9,0],[-13,0,7,0],[-12,0,6,0],[11,0,0,0],[-10,0,5,0],[-8,0,3,0],[7,0,-3,0],[-7,0,0,0],[-7,0,3,0],[-7,0,3,0],[6,0,0,0],[6,0,-3,0],[6,0,-3,0],[-6,0,3,0],[-6,0,3,0],[5,0,0,0],[-5,0,3,0],[-5,0,3,0],[-5,0,3,0],[4,0,0,0],[4,0,0,0],[4,0,0,0],[-4,0,0,0],[-4,0,0,0],[-4,0,0,0],[3,0,0,0],
[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0],[-3,0,0,0]],b=297.85036*DEG2RAD,c=445267.11148*DEG2RAD,f=-.0019142*DEG2RAD,g=DEG2RAD/189474,d=357.52772*DEG2RAD,e=35999.05034*DEG2RAD,h=-.0086972*DEG2RAD,k=-DEG2RAD/3E5,l=134.96298*DEG2RAD,m=477198.867398*DEG2RAD,p=.0086972*DEG2RAD,q=DEG2RAD/56250,w=93.27191*DEG2RAD,u=483202.017538*DEG2RAD,v=-.0036825*DEG2RAD,x=DEG2RAD/327270,z=125.04452*DEG2RAD,I=-1934.136261*DEG2RAD,O=.0020708*DEG2RAD,L=DEG2RAD/45E4,M=280.46061837*DEG2RAD,n=360.98564736629*
DEG2RAD,D=3.87933E-4*DEG2RAD,B=-DEG2RAD/3871E4;y.JDtoJDE=function(r){return r+H(r)/JD2SEC};y.JDEtoJD=function(r){return r-H(r)/JD2SEC};y.getMeanSiderealTime=K;y.getApparentSiderealTime=function(r){var t=F(r);return K(r)+t.longitude/1*Math.cos(t.obliquity)};y.getNutation=F})(this);"use strict";(function(y){function F(){return{p:this.p,l:this.l,z:this.z}}function H(){return{x:this.x,y:this.y,z:this.z}}function K(){return{l:this.l,b:this.b,i:this.i,r:this.r}}function A(){this.r=Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z);this.i=Math.acos(this.z/this.r);this.b=Q/2-this.i;this.l=Math.atan2(this.y,this.x);return(this.sph=K).call(this)}function G(){var n=this.r*Math.sin(this.i);this.x=n*Math.cos(this.l);this.y=n*Math.sin(this.l);this.z=this.r*Math.cos(this.i);return(this.cart=H).call(this)}function a(){this.p=Math.sqrt(this.x*this.x+this.y*this.y);this.l=Math.atan2(this.y,this.x);return(this.cyl=F).call(this)}function b(){this.x=this.p*Math.cos(this.l);this.y=this.p*Math.sin(this.l);return(this.cart=
H).call(this)}function c(){this.i=Math.atan2(this.p,this.z);this.b=Q/2-this.i;this.r=Math.sqrt(this.p*this.p+this.z*this.z);return(this.sph=K).call(this)}function f(){this.p=this.r*Math.cos(this.b);this.z=this.r*Math.sin(this.b);return(this.cyl=F).call(this)}function g(n){"ra"in n&&(n.l=n.ra);"dec"in n&&(n.b=n.dec);"dist"in n&&(n.r=n.dist);"x"in n&&"y"in n&&"z"in n?(this.x=n.x,this.y=n.y,this.z=n.z,this.cart=H,this.sph=A,this.cyl=a):"p"in n&&"l"in n&&"z"in n?(this.p=n.p,this.l=n.l,this.z=n.z,this.cart=
b,this.sph=c,this.cyl=F):"l"in n&&(this.l=n.l,this.r=n.r||1,"i"in n||"b"in n)&&(this.cart=G,this.sph=K,this.cyl=f,"b"in n?(this.b=n.b,this.i=Q/2-this.b):"i"in n&&(this.i=n.i,this.b=Q/2-this.i))}g.prototype.ecl2equ=function(n){var D=this.cart(),B=Math.sin(n);n=Math.cos(n);return new g({x:D.x,y:D.y*n-D.z*B,z:D.z*n+D.y*B})};g.prototype.equ2ecl=function(n){var D=this.cart(),B=Math.sin(n);n=Math.cos(n);return new g({x:D.x,y:D.y*n+D.z*B,z:D.z*n-D.y*B})};var d=32.932*DEG2RAD,e=192.859508*DEG2RAD,h=27.128336*
DEG2RAD;g.prototype.gal2equ=function(){var n=this.sph(),D=n.l,B=n.b;n=Math.sin(B);B=Math.cos(B);var r=Math.sin(h),t=Math.cos(h),C=B*Math.sin(D-d),E=Math.asin(n*r+C*t);return{l:CYCLE(Math.atan2(B*Math.cos(D-d),n*t-C*r)+e),b:TURN(E)}};g.prototype.equ2gal=function(){var n=this.sph(),D=n.l,B=n.b;n=Math.sin(B);B=Math.cos(B);var r=Math.sin(h),t=Math.cos(h),C=Math.cos(e-D),E=Math.asin(n*r+B*t*C);return{l:CYCLE(d-Math.atan2(Math.sin(e-D),C*r-n/B*t)-Q/2),b:TURN(E)}};var k=2306.2181*DEG2RAD,l=1.39656*DEG2RAD,
m=1.39E-4*DEG2RAD,p=.30188*DEG2RAD,q=3.44E-4*DEG2RAD,w=.017998*DEG2RAD,u=1.09468*DEG2RAD,v=6.6E-5*DEG2RAD,x=.018203*DEG2RAD,z=2004.3109*DEG2RAD,I=.8533*DEG2RAD,O=.42665*DEG2RAD,L=2.17E-4*DEG2RAD,M=.041833*DEG2RAD;g.prototype.precess=function(n,D){var B=this.l,r=this.b;var t=(n-D)/36E4;var C=t*t,E=C*t;if(t){var P=D/36E4;var S=P*P;D=(k+l*P-m*S)*t+(u+v*P)*C+x*E;n=(k+l*P-m*S)*t+(p-q*P)*C+w*E;t=(z-I*P-L*S)*t-(O+L*P)*C-M*E}else D=k*t+u*C+M*E,n=k*t+p*C+w*E,t=z*t-L*C-M*E;E=Math.cos(r);C=E*Math.cos(B+n);B=
E*Math.sin(B+n);n=Math.cos(t)*C-Math.sin(t)*Math.sin(r);t=Math.sin(t)*C+Math.cos(t)*Math.sin(r);D=Math.atan2(B,n)+D;r>.4*Q||r<-.4*Q?(B=Math.acos(Math.sqrt(B*B+n*n)),0>r&&(B*=-1)):B=Math.asin(t);r={l:CYCLE(D),b:TURN(B)};"r"in this&&(r.r=this.r);return r};y.Coord=g})(this)}).call(this,this);

/* crc: B8B9B4B4F49F17D761B10659551DAC77 */
