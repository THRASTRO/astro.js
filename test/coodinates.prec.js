(function () {
	'use strict';

	// local epsilon
	var EPSILON = 1e-6;

	// created via libnova
	// see ln_get_equ_prec
	var equp = [
		[1000.0000000000000, 267.4847239419042, -26.3518337585718],
		[13371.3269999999993, 267.9876133977889, -26.3288240608250],
		[25742.6539999999986, 268.4905736113835, -26.3042432383936],
		[38113.9809999999998, 268.9935900981197, -26.2780943035933],
		[50485.3079999999973, 269.4966484734224, -26.2503804067197],
		[62856.6349999999948, 269.9997344569633, -26.2211048350752],
		[75227.9619999999995, 270.5028338768465, -26.1902710119520],
		[87599.2890000000043, 271.0059326737225, -26.1578824955716],
		[99970.6160000000091, 271.5090169048279, -26.1239429779820],
		[112341.9430000000139, 272.0120727479495, -26.0884562839137],
		[124713.2700000000186, 272.5150865053085, -26.0514263695953],
		[137084.5970000000088, 273.0180446073634, -26.0128573215298],
		[149455.9239999999991, 273.5209336165292, -25.9727533552327],
		[161827.2509999999893, 274.0237402308107, -25.9311188139328],
		[174198.5779999999795, 274.5264512873474, -25.8879581672374],
		[186569.9049999999697, 275.0290537658685, -25.8432760097623],
		[198941.2319999999600, 275.5315347920562, -25.7970770597277],
		[211312.5589999999502, 276.0338816408152, -25.7493661575226],
		[223683.8859999999404, 276.5360817394470, -25.7001482642366],
		[236055.2129999999306, 277.0381226707278, -25.6494284601626],
		[248426.5399999999208, 277.5399921758878, -25.5972119432696],
		[260797.8669999999111, 278.0416781574920, -25.5435040276490],
		[273169.1939999999013, 278.5431686822194, -25.4883101419332],
		[285540.5209999998915, 279.0444519835427, -25.4316358276902],
		[297911.8479999998817, 279.5455164643037, -25.3734867377931],
		[310283.1749999998719, 280.0463506991868, -25.3138686347682],
		[322654.5019999998622, 280.5469434370889, -25.2527873891206],
		[335025.8289999998524, 281.0472836033848, -25.1902489776409],
		[347397.1559999998426, 281.5473603020880, -25.1262594816918],
		[359768.4829999998328, 282.0471628179066, -25.0608250854782],
		[372139.8099999998230, 282.5466806181951, -24.9939520743011],
		[384511.1369999998133, 283.0459033547997, -24.9256468327954],
		[396882.4639999998035, 283.5448208657996, -24.8559158431556],
		[409253.7909999997937, 284.0434231771434, -24.7847656833477],
		[421625.1179999997839, 284.5417005041805, -24.7122030253110],
		[433996.4449999997742, 285.0396432530885, -24.6382346331494],
		[446367.7719999997644, 285.5372420221975, -24.5628673613142],
		[458739.0989999997546, 286.0344876032102, -24.4861081527796],
		[471110.4259999997448, 286.5313709823203, -24.4079640372117],
		[483481.7529999997350, 287.0278833412293, -24.3284421291327],
		[495853.0799999997253, 287.5240160580621, -24.2475496260814],
		[508224.4069999997155, 288.0197607081827, -24.1652938067708],
		[520595.7339999997057, 288.5151090649118, -24.0816820292444],
		[532967.0609999997541, 289.0100531001455, -23.9967217290319],
		[545338.3879999998026, 289.5045849848786, -23.9104204173059],
		[557709.7149999998510, 289.9986970896322, -23.8227856790405],
		[570081.0419999998994, 290.4923819847872, -23.7338251711727],
		[582452.3689999999478, 290.9856324408253, -23.6435466207674],
		[594823.6959999999963, 291.4784414284796, -23.5519578231888],
		[607195.0230000000447, 291.9708021187949, -23.4590666402757],
		[619566.3500000000931, 292.4627078831004, -23.3648809985262],
		[631937.6770000001416, 292.9541522928960, -23.2694088872884],
		[644309.0040000001900, 293.4451291196545, -23.1726583569611],
		[656680.3310000002384, 293.9356323345402, -23.0746375172042],
		[669051.6580000002868, 294.4256561080470, -22.9753545351598],
		[681422.9850000003353, 294.9151948095569, -22.8748176336843],
		[693794.3120000003837, 295.4042430068215, -22.7730350895942],
		[706165.6390000004321, 295.8927954653677, -22.6700152319239],
		[718536.9660000004806, 296.3808471478299, -22.5657664401981],
		[730908.2930000005290, 296.8683932132104, -22.4602971427191],
		[743279.6200000005774, 297.3554290160709, -22.3536158148690],
		[755650.9470000006258, 297.8419501056553, -22.2457309774290],
		[768022.2740000006743, 298.3279522249477, -22.1366511949147],
		[780393.6010000007227, 298.8134313096662, -22.0263850739294],
		[792764.9280000007711, 299.2983834871956, -21.9149412615354],
		[805136.2550000008196, 299.7828050754604, -21.8023284436446],
		[817507.5820000008680, 300.2666925817398, -21.6885553434268],
		[829878.9090000009164, 300.7500427014284, -21.5736307197401],
		[842250.2360000009649, 301.2328523167423, -21.4575633655796],
		[854621.5630000010133, 301.7151184953748, -21.3403621065484],
		[866992.8900000010617, 302.1968384891022, -21.2220357993487],
		[879364.2170000011101, 302.6780097323426, -21.1025933302955],
		[891735.5440000011586, 303.1586298406696, -20.9820436138524],
		[904106.8710000012070, 303.6386966092825, -20.8603955911888],
		[916478.1980000012554, 304.1182080114358, -20.7376582287616],
		[928849.5250000013039, 304.5971621968284, -20.6138405169186],
		[941220.8520000013523, 305.0755574899572, -20.4889514685265],
		[953592.1790000014007, 305.5533923884338, -20.3630001176217],
		[965963.5060000014491, 306.0306655612687, -20.2359955180860],
		[978334.8330000014976, 306.5073758471237, -20.1079467423458],
		[990706.1600000015460, 306.9835222525353, -19.9788628800963],
		[1003077.4870000015944, 307.4591039501091, -19.8487530370501],
		[1015448.8140000016429, 307.9341202766897, -19.7176263337105],
		[1027820.1410000016913, 308.4085707315052, -19.5854919041701],
		[1040191.4680000017397, 308.8824549742903, -19.4523588949340],
		[1052562.7950000017881, 309.3557728233883, -19.3182364637687],
		[1064934.1220000018366, 309.8285242538343, -19.1831337785758],
		[1077305.4490000018850, 310.3007093954206, -19.0470600162913],
		[1089676.7760000019334, 310.7723285307475, -18.9100243618099],
		[1102048.1030000019819, 311.2433820932588, -18.7720360069354],
		[1114419.4300000020303, 311.7138706652663, -18.6331041493556],
		[1126790.7570000020787, 312.1837949759614, -18.4932379916434],
		[1139162.0840000021271, 312.6531558994191, -18.3524467402825],
		[1151533.4110000021756, 313.1219544525929, -18.2107396047189],
		[1163904.7380000022240, 313.5901917933033, -18.0681257964378],
		[1176276.0650000022724, 314.0578692182208, -17.9246145280650],
		[1188647.3920000023209, 314.5249881608460, -17.7802150124939],
		[1201018.7190000023693, 314.9915501894855, -17.6349364620378],
		[1213390.0460000024177, 315.4575570052276, -17.4887880876059],
		[1225761.3730000024661, 315.9230104399177, -17.3417790979056],
		[1238132.7000000025146, 316.3879124541343, -17.1939186986679],
		[1250504.0270000025630, 316.8522651351672, -17.0452160918985],
		[1262875.3540000026114, 317.3160706949997, -16.8956804751524],
		[1275246.6810000026599, 317.7793314682942, -16.7453210408327],
		[1287618.0080000027083, 318.2420499103838, -16.5941469755138],
		[1299989.3350000027567, 318.7042285952694, -16.4421674592878],
		[1312360.6620000028051, 319.1658702136255, -16.2893916651348],
		[1324731.9890000028536, 319.6269775708125, -16.1358287583161],
		[1337103.3160000029020, 320.0875535848998, -15.9814878957910],
		[1349474.6430000029504, 320.5476012846970, -15.8263782256561],
		[1361845.9700000029989, 321.0071238077971, -15.6705088866075],
		[1374217.2970000030473, 321.4661243986309, -15.5138890074248],
		[1386588.6240000030957, 321.9246064065327, -15.3565277064783],
		[1398959.9510000031441, 322.3825732838205, -15.1984340912571],
		[1411331.2780000031926, 322.8400285838878, -15.0396172579190],
		[1423702.6050000032410, 323.2969759593110, -14.8800862908625],
		[1436073.9320000032894, 323.7534191599711, -14.7198502623188],
		[1448445.2590000033379, 324.2093620311900, -14.5589182319653],
		[1460816.5860000033863, 324.6648085118835, -14.3972992465597],
		[1473187.9130000034347, 325.1197626327303, -14.2350023395937],
		[1485559.2400000034831, 325.5742285143572, -14.0720365309674],
		[1497930.5670000035316, 326.0282103655421, -13.9084108266830],
		[1510301.8940000035800, 326.4817124814344, -13.7441342185576],
		[1522673.2210000036284, 326.9347392417931, -13.5792156839561],
		[1535044.5480000036769, 327.3872951092428, -13.4136641855415],
		[1547415.8750000037253, 327.8393846275495, -13.2474886710447],
		[1559787.2020000037737, 328.2910124199137, -13.0806980730523],
		[1572158.5290000038221, 328.7421831872834, -12.9133013088118],
		[1584529.8560000038706, 329.1929017066865, -12.7453072800553],
		[1596901.1830000039190, 329.6431728295822, -12.5767248728395],
		[1609272.5100000039674, 330.0930014802326, -12.4075629574033],
		[1621643.8370000040159, 330.5423926540932, -12.2378303880421],
		[1634015.1640000040643, 330.9913514162249, -12.0675360029979],
		[1646386.4910000041127, 331.4398828997242, -11.8966886243661],
		[1658757.8180000041611, 331.8879923041753, -11.7252970580180],
		[1671129.1450000042096, 332.3356848941207, -11.5533700935384],
		[1683500.4720000042580, 332.7829659975538, -11.3809165041784],
		[1695871.7990000043064, 333.2298410044300, -11.2079450468239],
		[1708243.1260000043549, 333.6763153651991, -11.0344644619773],
		[1720614.4530000044033, 334.1223945893579, -10.8604834737546],
		[1732985.7800000044517, 334.5680842440225, -10.6860107898961],
		[1745357.1070000045002, 335.0133899525212, -10.5110551017905],
		[1757728.4340000045486, 335.4583173930066, -10.3356250845129],
		[1770099.7610000045970, 335.9028722970889, -10.1597293968757],
		[1782471.0880000046454, 336.3470604484885, -9.9833766814919],
		[1794842.4150000046939, 336.7908876817073, -9.8065755648516],
		[1807213.7420000047423, 337.2343598807213, -9.6293346574104],
		[1819585.0690000047907, 337.6774829776915, -9.4516625536897],
		[1831956.3960000048392, 338.1202629516944, -9.2735678323887],
		[1844327.7230000048876, 338.5627058274716, -9.0950590565080],
		[1856699.0500000049360, 339.0048176741977, -8.9161447734840],
		[1869070.3770000049844, 339.4466046042683, -8.7368335153345],
		[1881441.7040000050329, 339.8880727721044, -8.5571337988145],
		[1893813.0310000050813, 340.3292283729769, -8.3770541255826],
		[1906184.3580000051297, 340.7700776418481, -8.1966029823773],
		[1918555.6850000051782, 341.2106268522309, -8.0157888412032],
		[1930927.0120000052266, 341.6508823150658, -7.8346201595265],
		[1943298.3390000052750, 342.0908503776150, -7.6531053804798],
		[1955669.6660000053234, 342.5305374223732, -7.4712529330764],
		[1968040.9930000053719, 342.9699498659953, -7.2890712324325],
		[1980412.3200000054203, 343.4090941582401, -7.1065686799984],
		[1992783.6470000054687, 343.8479767809301, -6.9237536637981],
		[2000000.0000000000000, 344.1038643724500, -6.8169743708098],
		[2005154.9740000055172, 344.2866042469275, -6.7406345586765],
		[2017526.3010000055656, 344.7249830991243, -6.5572197265547],
		[2029897.6280000056140, 345.1631199094489, -6.3735175166926],
		[2042268.9550000056624, 345.6010212778864, -6.1895362659586],
		[2054640.2820000057109, 346.0386938315137, -6.0052842991073],
		[2067011.6090000057593, 346.4761442235481, -5.8207699290624],
		[2079382.9360000058077, 346.9133791324102, -5.6360014572082],
		[2091754.2630000058562, 347.3504052608000, -5.4509871736852],
		[2104125.5900000059046, 347.7872293347849, -5.2657353576940],
		[2116496.9170000059530, 348.2238581029016, -5.0802542778038],
		[2128868.2440000060014, 348.6602983352695, -4.8945521922666],
		[2141239.5710000060499, 349.0965568227160, -4.7086373493378],
		[2153610.8980000060983, 349.5326403759125, -4.5225179876009],
		[2165982.2250000061467, 349.9685558245230, -4.3362023362983],
		[2178353.5520000061952, 350.4043100163615, -4.1496986156659],
		[2190724.8790000062436, 350.8399098165611, -3.9630150372736],
		[2203096.2060000062920, 351.2753621067516, -3.7761598043687],
		[2215467.5330000063404, 351.7106737842479, -3.5891411122249],
		[2227838.8600000063889, 352.1458517612461, -3.4019671484944],
		[2240210.1870000064373, 352.5809029640291, -3.2146460935642],
		[2252581.5140000064857, 353.0158343321795, -3.0271861209160],
		[2264952.8410000065342, 353.4506528178015, -2.8395953974894],
		[2277324.1680000065826, 353.8853653847492, -2.6518820840480],
		[2289695.4950000066310, 354.3199790078615, -2.4640543355495],
		[2302066.8220000066794, 354.7545006722050, -2.2761203015175],
		[2314438.1490000067279, 355.1889373723214, -2.0880881264164],
		[2326809.4760000067763, 355.6232961114812, -1.8999659500290],
		[2339180.8030000068247, 356.0575839009430, -1.7117619078361],
		[2351552.1300000068732, 356.4918077592170, -1.5234841313976],
		[2363923.4570000069216, 356.9259747113330, -1.3351407487367],
		[2376294.7840000069700, 357.3600917881126, -1.1467398847246],
		[2388666.1110000070184, 357.7941660254448, -0.9582896614675],
		[2401037.4380000070669, 358.2282044635646, -0.7697981986943],
		[2413408.7650000071153, 358.6622141463339, -0.5812736141459],
		[2425780.0920000071637, 359.0962021205256, -0.3927240239651],
		[2438151.4190000072122, 359.5301754351083, -0.2041575430874],
		[2450522.7460000072606, 359.9641411405335, -0.0155822856326],
		[2462894.0730000073090, 0.3981062880225, 0.1729936347040],
		[2475265.4000000073574, 0.8320779288547, 0.3615621042590],
		[2487636.7270000074059, 1.2660631136556, 0.5501150090096],
		[2500008.0540000074543, 1.7000688916843, 0.7386442341812],
		[2512379.3810000075027, 2.1341023101204, 0.9271416638566],
		[2524750.7080000075512, 2.5681704133496, 1.1155991805845],
		[2537122.0350000075996, 3.0022802422471, 1.3040086649898],
		[2549493.3620000076480, 3.4364388334597, 1.4923619953842],
		[2561864.6890000076964, 3.8706532186848, 1.6806510473779],
		[2574236.0160000077449, 4.3049304239463, 1.8688676934928],
		[2586607.3430000077933, 4.7392774688673, 2.0570038027770],
		[2598978.6700000078417, 5.1737013659390, 2.2450512404211],
		[2611349.9970000078902, 5.6082091197853, 2.4330018673763],
		[2623721.3240000079386, 6.0428077264220, 2.6208475399743],
		[2636092.6510000079870, 6.4775041725121, 2.8085801095495],
		[2648463.9780000080355, 6.9123054346141, 2.9961914220640],
		[2660835.3050000080839, 7.3472184784257, 3.1836733177348],
		[2673206.6320000081323, 7.7822502580196, 3.3710176306635],
		[2685577.9590000081807, 8.2174077150740, 3.5582161884700],
		[2697949.2860000082292, 8.6526977780943, 3.7452608119282],
		[2710320.6130000082776, 9.0881273616282, 3.9321433146057],
		[2722691.9400000083260, 9.5237033654725, 4.1188555025073],
		[2735063.2670000083745, 9.9594326738706, 4.3053891737214],
		[2747434.5940000084229, 10.3953221547025, 4.4917361180716],
		[2759805.9210000084713, 10.8313786586638, 4.6778881167711],
		[2772177.2480000085197, 11.2676090184363, 4.8638369420828],
		[2784548.5750000085682, 11.7040200478480, 5.0495743569831],
		[2796919.9020000086166, 12.1406185410219, 5.2350921148307],
		[2809291.2290000086650, 12.5774112715154, 5.4203819590407],
		[2821662.5560000087135, 13.0144049914464, 5.6054356227635],
		[2834033.8830000087619, 13.4516064306097, 5.7902448285697],
		[2846405.2100000088103, 13.8890222955795, 5.9748012881400],
		[2858776.5370000088587, 14.3266592688008, 6.1590967019613],
		[2871147.8640000089072, 14.7645240076673, 6.3431227590291],
		[2883519.1910000089556, 15.2026231435858, 6.5268711365560],
		[2895890.5180000090040, 15.6409632810282, 6.7103334996866],
		[2908261.8450000090525, 16.0795509965677, 6.8935015012194],
		[2920633.1720000091009, 16.5183928379028, 7.0763667813359],
		[2933004.4990000091493, 16.9574953228652, 7.2589209673363],
		[2945375.8260000091977, 17.3968649384129, 7.4411556733836],
		[2957747.1530000092462, 17.8365081396089, 7.6230625002545],
		[2970118.4800000092946, 18.2764313485832, 7.8046330350989],
		[2982489.8070000093430, 18.7166409534795, 7.9858588512072],
		[2994861.1340000093915, 19.1571433073853, 8.1667315077866]
	];

	QUnit.module( 'Precession', function ()
	{
		QUnit.test( 'Equatorial', function( assert )
		{
			for (var i = 0; i < equp.length; i ++) {
				var prec = new Coord({ l: 0, b: 0, r: 1 })
				var JD = equp[i][0], l = equp[i][1], b = equp[i][2];
				var T = parseInt(JD * 10, 10) / 10;
				assert.ok(prec = prec.precess(JD2J2K(JD), JD2J2K(T2K)), 'JD ' + T + ': Precess to JD');
				assert.close(prec.l * RAD2DEG, l, EPSILON, 'JD ' + T + ': Right Ascension (ra)');
				assert.close(prec.b * RAD2DEG, b, EPSILON, 'JD ' + T + ': Declination (dec)');
			}
		});
	});

})();